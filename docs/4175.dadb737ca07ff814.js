"use strict";var Wt=Object.defineProperty,$t=Object.defineProperties,Ht=Object.getOwnPropertyDescriptors,zt=Object.getOwnPropertySymbols,Tt=Object.prototype.hasOwnProperty,Yt=Object.prototype.propertyIsEnumerable,Bt=(ot,$,N)=>$ in ot?Wt(ot,$,{enumerable:!0,configurable:!0,writable:!0,value:N}):ot[$]=N,kt=(ot,$)=>{for(var N in $||($={}))Tt.call($,N)&&Bt(ot,N,$[N]);if(zt)for(var N of zt($))Yt.call($,N)&&Bt(ot,N,$[N]);return ot},Et=(ot,$)=>$t(ot,Ht($));(self.webpackChunksite=self.webpackChunksite||[]).push([[4175],{47139:(ot,$,N)=>{N.d($,{RL:()=>R,bk:()=>E,Fp:()=>st,UV:()=>s});var lt=N(36161),mt=N(91179),it=N(31375);function st(m){if(!m)return null;switch(m.type){case"CIMPointSymbol":{const S=m.symbolLayers;return S&&1===S.length?st(S[0]):null}case"CIMVectorMarker":{var p;const S=m.markerGraphics;if(!S||1!==S.length)return null;const d=S[0];if(!d)return null;const x=d.geometry;if(!x)return null;const P=d.symbol;return!P||"CIMPolygonSymbol"!==P.type&&"CIMLineSymbol"!==P.type||null!=(p=P.symbolLayers)&&p.some(M=>!!M.effects)?null:{geom:x,asFill:"CIMPolygonSymbol"===P.type}}case"sdf":return{geom:m.geom,asFill:m.asFill}}return null}function v(m){let p=1/0,S=-1/0,d=1/0,x=-1/0;for(const P of m)for(const M of P)M[0]<p&&(p=M[0]),M[0]>S&&(S=M[0]),M[1]<d&&(d=M[1]),M[1]>x&&(x=M[1]);return[p,d,S,x]}function E(m){return m?m.rings?v(m.rings):m.paths?v(m.paths):(0,mt.YX)(m)?[m.xmin,m.ymin,m.xmax,m.ymax]:null:null}function s(m,p,S,d,x){const[P,M,L,w]=m;if(L<P||w<M)return[0,0,0];const X=L-P,A=w-M,H=Math.floor(31.5),U=(128-2*(H+1))/Math.max(X,A),G=Math.round(X*U)+2*H,rt=Math.round(A*U)+2*H;let q=1;p&&(q=rt/U/(p.ymax-p.ymin));let W=0,T=0;return d&&(x?p&&S&&p.ymax-p.ymin>0&&(W=d.x/(S*((p.xmax-p.xmin)/(p.ymax-p.ymin))),T=d.y/S):(W=d.x,T=d.y)),W=.5*(p.xmax+p.xmin)+W*(p.xmax-p.xmin),T=.5*(p.ymax+p.ymin)+T*(p.ymax-p.ymin),W-=P,T-=M,W*=U,T*=U,W+=H,T+=H,[q,W/G-.5,-(T/rt-.5)]}function R(m){const p=function I(m){return m?m.rings?m.rings:m.paths?m.paths:void 0!==m.xmin&&void 0!==m.ymin&&void 0!==m.xmax&&void 0!==m.ymax?[[[m.xmin,m.ymin],[m.xmin,m.ymax],[m.xmax,m.ymax],[m.xmax,m.ymin],[m.xmin,m.ymin]]]:null:null}(m.geom),S=function pt(m){let p=1/0,S=-1/0,d=1/0,x=-1/0;for(const P of m)for(const M of P)M[0]<p&&(p=M[0]),M[0]>S&&(S=M[0]),M[1]<d&&(d=M[1]),M[1]>x&&(x=M[1]);return new it.Z(p,d,S-p,x-d)}(p),P=Math.floor(31.5),M=(128-2*(P+1))/Math.max(S.width,S.height),L=Math.round(S.width*M)+2*P,w=Math.round(S.height*M)+2*P,X=[];for(const z of p)if(z&&z.length>1){const B=[];for(const H of z){let[U,G]=H;U-=S.x,G-=S.y,U*=M,G*=M,U+=P-.5,G+=P-.5,B.push(m.asFill?[U,G]:[Math.round(U),Math.round(G)])}if(m.asFill){const H=B.length-1;B[0][0]===B[H][0]&&B[0][1]===B[H][1]||B.push(B[0])}X.push(B)}const A=function k(m,p,S,d){const x=p*S,P=new Array(x),M=d*d+1;for(let L=0;L<x;++L)P[L]=M;for(const L of m){const w=L.length;for(let X=1;X<w;++X){const A=L[X-1],z=L[X];let B,H,U,G;A[0]<z[0]?(B=A[0],H=z[0]):(B=z[0],H=A[0]),A[1]<z[1]?(U=A[1],G=z[1]):(U=z[1],G=A[1]);let rt=Math.floor(B)-d,q=Math.floor(H)+d,W=Math.floor(U)-d,T=Math.floor(G)+d;rt<0&&(rt=0),q>p&&(q=p),W<0&&(W=0),T>S&&(T=S);const Y=z[0]-A[0],vt=z[1]-A[1],Lt=Y*Y+vt*vt;for(let ut=rt;ut<q;ut++)for(let gt=W;gt<T;gt++){let ht,V,a=(ut-A[0])*Y+(gt-A[1])*vt;a<0?(ht=A[0],V=A[1]):a>Lt?(ht=z[0],V=z[1]):(a/=Lt,ht=A[0]+a*Y,V=A[1]+a*vt);const dt=(ut-ht)*(ut-ht)+(gt-V)*(gt-V),At=(S-gt-1)*p+ut;dt<P[At]&&(P[At]=dt)}}}for(let L=0;L<x;++L)P[L]=Math.sqrt(P[L]);return P}(X,L,w,P);return m.asFill&&function J(m,p,S,d,x){for(const P of m){const M=P.length;for(let L=1;L<M;++L){const w=P[L-1],X=P[L];let A,z,B,H;w[0]<X[0]?(A=w[0],z=X[0]):(A=X[0],z=w[0]),w[1]<X[1]?(B=w[1],H=X[1]):(B=X[1],H=w[1]);let U=Math.floor(A),G=Math.floor(z)+1,rt=Math.floor(B),q=Math.floor(H)+1;U<d&&(U=d),G>p-d&&(G=p-d),rt<d&&(rt=d),q>S-d&&(q=S-d);for(let W=rt;W<q;++W){if(w[1]>W==X[1]>W)continue;const T=(S-W-1)*p;for(let Y=U;Y<G;++Y)Y<(X[0]-w[0])*(W-w[1])/(X[1]-w[1])+w[0]&&(x[T+Y]=-x[T+Y]);for(let Y=d;Y<U;++Y)x[T+Y]=-x[T+Y]}}}}(X,L,w,P,A),[Z(A,P),L,w]}function Z(m,p){const S=2*p,d=m.length,x=new Uint8Array(4*d);for(let P=0;P<d;++P)(0,lt.I)(.5-m[P]/S,x,4*P);return x}},84175:(ot,$,N)=>{N.d($,{S:()=>At,c:()=>L});var lt=N(15861),mt=N(91558),it=N(63290),st=N(62208),yt=N(23841),I=N(77275),pt=N(46679),v=N(35909),E=N(47139),s=N(80991),R=N(73608),k=N(39236);const J=it.Z.getLogger("esri.symbols.cim.cimAnalyzer");function Z(t){switch(t){case"Butt":return 0;case"Square":return 2;default:return 1}}function m(t){switch(t){case"Bevel":return 0;case"Miter":return 2;default:return 1}}function p(t){switch(t){case"Left":default:return"left";case"Right":return"right";case"Center":return"center";case"Justify":return"justify"}}function S(t){switch(t){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function P(t,i,o,n){let e;t[i]?e=t[i]:(e={},t[i]=e),e[o]=n}function M(t){const i=t.markerPlacement;return i&&i.angleToLine?1:0}function L(t,i,o,n,e){return w.apply(this,arguments)}function w(){return(w=(0,lt.Z)(function*(t,i,o,n,e){const l=null!=n?n:[];if(!t)return l;let h,c;const f={};if("CIMSymbolReference"!==t.type)return J.error("Expect cim type to be 'CIMSymbolReference'"),l;if(h=t.symbol,c=t.primitiveOverrides,c){const g=[];for(const _ of c){const r=_.valueExpressionInfo;if(r&&i){const b=(0,pt.Yi)(r.expression,i.spatialReference,i.fields).then(O=>{O&&P(f,_.primitiveName,_.propertyName,O)});g.push(b)}else null!=_.value&&P(f,_.primitiveName,_.propertyName,_.value)}g.length>0&&(yield Promise.all(g))}const y=[];switch(Xt(h,o,y),y.length>0&&(yield Promise.all(y)),h.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":X(h,c,f,i,l,o,e)}return l})).apply(this,arguments)}function X(t,i,o,n,e,l,h){if(!t)return;const c=t.symbolLayers;if(!c)return;const f=t.effects;let y;const g=v.B$.getSize(t);"CIMPointSymbol"===t.type&&"Map"===t.angleAlignment&&(y=1);let _=c.length;for(;_--;){const r=c[_];if(!r||!1===r.enable)continue;let u;f&&f.length&&(u=[...f]);const b=r.effects;b&&b.length&&(f?u.push(...b):u=[...b]);const O=[];switch(v.E0.findApplicableOverrides(r,i,O),r.type){case"CIMSolidFill":A(r,u,o,O,n,e);break;case"CIMPictureFill":z(r,u,o,O,n,l,e);break;case"CIMHatchFill":B(r,u,o,O,n,e);break;case"CIMGradientFill":H(r,u,o,O,n,e);break;case"CIMSolidStroke":U(r,u,o,O,n,e,"CIMPolygonSymbol"===t.type,g);break;case"CIMPictureStroke":G(r,u,o,O,n,e,"CIMPolygonSymbol"===t.type,g);break;case"CIMGradientStroke":rt(r,u,o,O,n,e,"CIMPolygonSymbol"===t.type,g);break;case"CIMCharacterMarker":if(q(r,u,o,O,n,e))break;break;case"CIMPictureMarker":if(q(r,u,o,O,n,e))break;"CIMLineSymbol"===t.type&&(y=M(r)),W(r,u,o,O,n,l,e,y,g);break;case"CIMVectorMarker":if(q(r,u,o,O,n,e))break;"CIMLineSymbol"===t.type&&(y=M(r)),T(r,u,o,O,n,e,l,y,g,h);break;default:J.error("Cannot analyze CIM layer",r.type)}}}function A(t,i,o,n,e,l){const h=t.primitiveName,c=(0,s.NO)(t.color),[f,y]=at(n,h),g=(0,I.hP)(JSON.stringify(t)+y).toString();l.push({type:"fill",templateHash:g,materialHash:f?()=>g:g,cim:t,materialOverrides:null,colorLocked:t.colorLocked,color:a(h,o,"Color",e,c,V),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:i})}function z(t,i,o,n,e,l,h){const c=t.primitiveName,f=t.tintColor?(0,s.NO)(t.tintColor):{r:255,g:255,b:255,a:1},[y,g]=at(n,c),_=(0,I.hP)(JSON.stringify(t)+g).toString(),r=(0,I.hP)(`${t.url}${JSON.stringify(t.colorSubstitutions)}`).toString();let u=(0,s.NA)(t.scaleX);if("width"in t){const b=t.width;let O=1;const D=l.getResource(t.url);(0,st.pC)(D)&&(O=D.width/D.height),u/=O*(t.height/b)}h.push({type:"fill",templateHash:_,materialHash:y?()=>r:r,cim:t,materialOverrides:null,colorLocked:t.colorLocked,effects:i,color:a(c,o,"TintColor",e,f,V),height:a(c,o,"Height",e,t.height),scaleX:a(c,o,"ScaleX",e,u),angle:a(c,o,"Rotation",e,(0,s.NA)(t.rotation)),offsetX:a(c,o,"OffsetX",e,(0,s.NA)(t.offsetX)),offsetY:a(c,o,"OffsetY",e,(0,s.NA)(t.offsetY)),url:t.url})}function B(t,i,o,n,e,l){const h=["Rotation","OffsetX","OffsetY"],c=n.filter(u=>u.primitiveName!==t.primitiveName&&-1===h.indexOf(u.propertyName)),f=t.primitiveName,[y,g]=at(n,f),_=(0,I.hP)(JSON.stringify(t)+g).toString(),r=(0,I.hP)(`${t.separation}${JSON.stringify(t.lineSymbol)}`).toString();l.push({type:"fill",templateHash:_,materialHash:y?dt(r,o,c,e):r,cim:t,materialOverrides:c,colorLocked:t.colorLocked,effects:i,color:{r:255,g:255,b:255,a:1},height:a(f,o,"Separation",e,t.separation),scaleX:1,angle:a(f,o,"Rotation",e,(0,s.NA)(t.rotation)),offsetX:a(f,o,"OffsetX",e,(0,s.NA)(t.offsetX)),offsetY:a(f,o,"OffsetY",e,(0,s.NA)(t.offsetY))})}function H(t,i,o,n,e,l){const h=t.primitiveName,[c,f]=at(n,h),y=(0,I.hP)(JSON.stringify(t)+f).toString();l.push({type:"fill",templateHash:y,materialHash:c?dt(y,o,n,e):y,cim:t,materialOverrides:null,colorLocked:t.colorLocked,effects:i,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1})}function U(t,i,o,n,e,l,h,c){const f=t.primitiveName,y=(0,s.NO)(t.color),g=void 0!==t.width?t.width:4,_=Z(t.capStyle),r=m(t.joinStyle),u=t.miterLimit,[b,O]=at(n,f),D=(0,I.hP)(JSON.stringify(t)+O).toString();let C,Q;if(i&&i.length>0){const K=i[i.length-1];if("CIMGeometricEffectDashes"===K.type&&"NoConstraint"===K.lineDashEnding){const F=(i=[...t.effects]).pop();C=F.dashTemplate,Q=F.scaleDash}}l.push({type:"line",templateHash:D,materialHash:b?()=>D:D,cim:t,materialOverrides:null,isOutline:h,colorLocked:t.colorLocked,effects:i,color:a(f,o,"Color",e,y,V),width:a(f,o,"Width",e,g),cap:a(f,o,"CapStyle",e,_),join:a(f,o,"JoinStyle",e,r),miterLimit:a(f,o,"MiterLimit",e,u),referenceWidth:c,zOrder:ht(t.name),dashTemplate:C,scaleDash:Q})}function G(t,i,o,n,e,l,h,c){const f=(0,I.hP)(`${t.url}${JSON.stringify(t.colorSubstitutions)}`).toString(),y=t.primitiveName,g=(0,s.NO)(t.tintColor),_=void 0!==t.width?t.width:4,r=Z(t.capStyle),u=m(t.joinStyle),b=t.miterLimit,[O,D]=at(n,y),C=(0,I.hP)(JSON.stringify(t)+D).toString();l.push({type:"line",templateHash:C,materialHash:O?()=>f:f,cim:t,materialOverrides:null,isOutline:h,colorLocked:t.colorLocked,effects:i,color:a(y,o,"TintColor",e,g,V),width:a(y,o,"Width",e,_),cap:a(y,o,"CapStyle",e,r),join:a(y,o,"JoinStyle",e,u),miterLimit:a(y,o,"MiterLimit",e,b),referenceWidth:c,zOrder:ht(t.name),dashTemplate:null,scaleDash:!1,url:t.url})}function rt(t,i,o,n,e,l,h,c){const f=t.primitiveName,y=void 0!==t.width?t.width:4,g=Z(t.capStyle),_=m(t.joinStyle),r=t.miterLimit,[u,b]=at(n,f),O=(0,I.hP)(JSON.stringify(t)+b).toString();l.push({type:"line",templateHash:O,materialHash:u?dt(O,o,n,e):O,cim:t,materialOverrides:null,isOutline:h,colorLocked:t.colorLocked,effects:i,color:{r:128,g:128,b:128,a:1},width:a(f,o,"Width",e,y),cap:a(f,o,"CapStyle",e,g),join:a(f,o,"JoinStyle",e,_),miterLimit:a(f,o,"MiterLimit",e,r),referenceWidth:c,zOrder:ht(t.name),dashTemplate:null,scaleDash:!1})}function q(t,i,o,n,e,l){const h=t.markerPlacement;if(!h||"CIMMarkerPlacementInsidePolygon"!==h.type)return!1;const c=h,f=["Rotation","OffsetX","OffsetY"],y=n.filter(C=>C.primitiveName!==t.primitiveName&&-1===f.indexOf(C.propertyName)),g="url"in t?t.url:null,[_,r]=at(n,c.primitiveName),u=(0,I.hP)(JSON.stringify(t)+r).toString();let b=c.stepY,O=null,D=1;return h.shiftOddRows&&(b*=2,O=function(C){return C?2*C:0},D=.5),l.push({type:"fill",templateHash:u,materialHash:_?dt(u,o,y,e):u,cim:t,materialOverrides:y,colorLocked:t.colorLocked,effects:i,color:{r:255,g:255,b:255,a:1},height:a(c.primitiveName,o,"StepY",e,b,O),scaleX:D,angle:a(c.primitiveName,o,"GridAngle",e,c.gridAngle),offsetX:a(c.primitiveName,o,"OffsetX",e,(0,s.NA)(c.offsetX)),offsetY:a(c.primitiveName,o,"OffsetY",e,(0,s.NA)(c.offsetY)),url:g}),!0}function W(t,i,o,n,e,l,h,c,f){var y;const g=t.primitiveName,_=(0,s.NA)(t.size);let r=(0,s.NA)(t.scaleX);const u=(0,s.NA)(t.rotation),b=(0,s.NA)(t.offsetX),O=(0,s.NA)(t.offsetY),D=t.tintColor?(0,s.NO)(t.tintColor):{r:255,g:255,b:255,a:1},C=(0,I.hP)(`${t.url}${JSON.stringify(t.colorSubstitutions)}`).toString(),[Q,K]=at(n,g),F=(0,I.hP)(JSON.stringify(t)+K).toString(),ct=null!=(y=t.anchorPoint)?y:{x:0,y:0};if("width"in t){const nt=t.width;let tt=1;const j=l.getResource(t.url);(0,st.pC)(j)&&(tt=j.width/j.height),r/=tt*(_/nt)}h.push({type:"marker",templateHash:F,materialHash:Q?()=>C:C,cim:t,materialOverrides:null,colorLocked:t.colorLocked,effects:i,scaleSymbolsProportionally:!1,alignment:c,size:a(g,o,"Size",e,_),scaleX:a(g,o,"ScaleX",e,r),rotation:a(g,o,"Rotation",e,u),offsetX:a(g,o,"OffsetX",e,b),offsetY:a(g,o,"OffsetY",e,O),color:a(g,o,"TintColor",e,D,V),anchorPoint:{x:ct.x,y:-ct.y},isAbsoluteAnchorPoint:"Relative"!==t.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:t.rotateClockwise,referenceSize:f,sizeRatio:1,markerPlacement:t.markerPlacement,url:t.url})}function T(t,i,o,n,e,l,h,c,f,y){const g=t.markerGraphics;if(!g)return;let _=0;if(t.scaleSymbolsProportionally){const r=t.frame;r&&(_=r.ymax-r.ymin)}for(const r of g)if(r){const u=r.symbol;if(!u)continue;switch(u.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":vt(t,i,r,n,o,e,l,h,c,f,_,y);break;case"CIMTextSymbol":Y(t,i,r,o,n,e,l,c,f,_)}}}function Y(t,i,o,n,e,l,h,c,f,y){v.E0.findApplicableOverrides(o,e,[]);const _=o.geometry;if(!("x"in _)||!("y"in _))return;const r=o.symbol,u=function x(t){return t.underline?"underline":t.strikethrough?"line-through":"none"}(r),b=function d(t){let i="",o="";if(t){const n=t.toLowerCase();-1!==n.indexOf("italic")?i="italic":-1!==n.indexOf("oblique")&&(i="oblique"),-1!==n.indexOf("bold")?o="bold":-1!==n.indexOf("light")&&(o="lighter")}return{style:i,weight:o}}(r.fontStyleName),O=(0,s.mA)(r.fontFamilyName);r.font=kt({family:O,decoration:u},b);const D=t.frame,C=_.x-.5*(D.xmin+D.xmax),Q=_.y-.5*(D.ymin+D.ymax),K=t.size/y,F=t.primitiveName,ct=(0,s.NA)(r.height)*K,nt=(0,s.NA)(r.angle),tt=((0,s.NA)(r.offsetX)+C)*K,j=((0,s.NA)(r.offsetY)+Q)*K,St=(0,s.NO)(v.B$.getFillColor(r));let Mt=(0,s.NO)(v.B$.getStrokeColor(r)),Ot=v.B$.getStrokeWidth(r);Ot||(Mt=(0,s.NO)(v.B$.getFillColor(r.haloSymbol)),Ot=r.haloSize*K);const[xt,Ct]=at(e,F),Pt=JSON.stringify(t.effects)+Number(t.colorLocked)+JSON.stringify(t.anchorPoint)+t.anchorPointUnits+JSON.stringify(t.markerPlacement),_t=(0,I.hP)(JSON.stringify(o)+Pt+Ct).toString(),ft=a(o.primitiveName,n,"TextString",l,o.textString,s.X3,r.textCase),{fontStyleName:bt}=r,et=O+(bt?"-"+bt.toLowerCase():"-regular"),It=et;h.push({type:"text",templateHash:_t,materialHash:xt||"function"==typeof ft||ft.match(/\[(.*?)\]/)?(Dt,wt,Rt)=>It+"-"+(0,s.hf)(ft,Dt,wt,Rt):It+"-"+(0,I.hP)(ft),cim:r,materialOverrides:null,colorLocked:t.colorLocked,effects:i,alignment:c,anchorPoint:{x:t.anchorPoint?t.anchorPoint.x:0,y:t.anchorPoint?t.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==t.anchorPointUnits,fontName:et,decoration:u,weight:a(F,n,"Weight",l,b.weight),style:a(F,n,"Size",l,b.style),size:a(F,n,"Size",l,ct),angle:a(F,n,"Rotation",l,nt),offsetX:a(F,n,"OffsetX",l,tt),offsetY:a(F,n,"OffsetY",l,j),horizontalAlignment:p(r.horizontalAlignment),verticalAlignment:S(r.verticalAlignment),text:ft,color:St,outlineColor:Mt,outlineSize:Ot,referenceSize:f,sizeRatio:1,markerPlacement:t.markerPlacement})}function vt(t,i,o,n,e,l,h,c,f,y,g,_){const r=o.symbol,u=r.symbolLayers;if(!u)return;if(_)return void ut(t,i,o,e,n,l,h,c,f,y,g);let b=u.length;if(Jt(u))return void function Lt(t,i,o,n,e,l,h,c,f,y){const g=i.geometry,_=o[0],r=o[1],u=(0,E.bk)(g);if(!u)return;const[b,O,D]=(0,E.UV)(u,t.frame,t.size,t.anchorPoint,"Relative"!==t.anchorPointUnits),C={type:"sdf",geom:g,asFill:!0},Q=t.primitiveName,K=(0,s.NA)(t.size),F=(0,s.NA)(t.rotation),ct=(0,s.NA)(t.offsetX),nt=(0,s.NA)(t.offsetY),tt=r.path,j=r.primitiveName,St=_.primitiveName,Mt=(0,s.NO)(v.B$.getFillColor(r)),Ot=(0,s.NO)(v.B$.getStrokeColor(_)),xt=v.B$.getStrokeWidth(_);let Ct=!1,Pt="";for(const et of n)et.primitiveName!==j&&et.primitiveName!==St&&et.primitiveName!==Q||(void 0!==et.value?Pt+=`-${et.primitiveName}-${et.propertyName}-${JSON.stringify(et.value)}`:et.valueExpressionInfo&&(Ct=!0));const _t=JSON.stringify(Et(kt({},t),{markerGraphics:null})),ft=(0,I.hP)(JSON.stringify(C)+tt).toString(),bt={type:"marker",templateHash:(0,I.hP)(JSON.stringify(i)+JSON.stringify(r)+JSON.stringify(_)+_t+Pt).toString(),materialHash:Ct?()=>ft:ft,cim:C,materialOverrides:null,colorLocked:t.colorLocked,effects:t.effects,scaleSymbolsProportionally:t.scaleSymbolsProportionally,alignment:c,anchorPoint:{x:O,y:D},isAbsoluteAnchorPoint:!1,size:a(t.primitiveName,e,"Size",l,K),rotation:a(t.primitiveName,e,"Rotation",l,F),offsetX:a(t.primitiveName,e,"OffsetX",l,ct),offsetY:a(t.primitiveName,e,"OffsetY",l,nt),scaleX:1,frameHeight:y,rotateClockwise:t.rotateClockwise,referenceSize:f,sizeRatio:b,color:a(j,e,"Color",l,Mt,V),outlineColor:a(St,e,"Color",l,Ot,V),outlineWidth:a(St,e,"Width",l,xt),markerPlacement:t.markerPlacement,path:tt};h.push(bt)}(t,o,u,n,e,l,h,f,y,g);const O=R.j.applyEffects(r.effects,o.geometry);if(O)for(;b--;){const C=u[b];if(C&&!1!==C.enable)switch(C.type){case"CIMSolidFill":case"CIMSolidStroke":{var D;const Q=R.j.applyEffects(C.effects,O),K=(0,E.bk)(Q);if(!K)continue;const[F,ct,nt]=(0,E.UV)(K,t.frame,t.size,t.anchorPoint,"Relative"!==t.anchorPointUnits),tt="CIMSolidFill"===C.type,j={type:"sdf",geom:Q,asFill:tt},St=t.primitiveName,Mt=null!=(D=(0,s.NA)(t.size))?D:10,Ot=(0,s.NA)(t.rotation),xt=(0,s.NA)(t.offsetX),Ct=(0,s.NA)(t.offsetY),Pt=C.path,_t=C.primitiveName,ft=(0,s.NO)(tt?v.B$.getFillColor(C):v.B$.getStrokeColor(C)),bt=tt?{r:0,g:0,b:0,a:0}:(0,s.NO)(v.B$.getStrokeColor(C)),et=v.B$.getStrokeWidth(C);if(!tt&&!et)break;let It=!1,Dt="";for(const Nt of n)Nt.primitiveName!==_t&&Nt.primitiveName!==St||(void 0!==Nt.value?Dt+=`-${Nt.primitiveName}-${Nt.propertyName}-${JSON.stringify(Nt.value)}`:Nt.valueExpressionInfo&&(It=!0));const wt=JSON.stringify(Et(kt({},t),{markerGraphics:null})),Rt=(0,I.hP)(JSON.stringify(j)+Pt).toString(),Ut={type:"marker",templateHash:(0,I.hP)(JSON.stringify(o)+JSON.stringify(C)+wt+Dt).toString(),materialHash:It?()=>Rt:Rt,cim:j,materialOverrides:null,colorLocked:t.colorLocked,effects:i,scaleSymbolsProportionally:t.scaleSymbolsProportionally,alignment:f,anchorPoint:{x:ct,y:nt},isAbsoluteAnchorPoint:!1,size:a(t.primitiveName,e,"Size",l,Mt),rotation:a(t.primitiveName,e,"Rotation",l,Ot),offsetX:a(t.primitiveName,e,"OffsetX",l,xt),offsetY:a(t.primitiveName,e,"OffsetY",l,Ct),scaleX:1,frameHeight:g,rotateClockwise:t.rotateClockwise,referenceSize:y,sizeRatio:F,color:a(_t,e,"Color",l,ft,V),outlineColor:a(_t,e,"Color",l,bt,V),outlineWidth:a(_t,e,"Width",l,et),markerPlacement:t.markerPlacement,path:Pt};h.push(Ut);break}default:ut(t,i,o,e,n,l,h,c,f,y,g)}}}function ut(t,i,o,n,e,l,h,c,f,y,g){const _=function gt(t,i){return{type:t.type,enable:!0,name:t.name,colorLocked:t.colorLocked,primitiveName:t.primitiveName,anchorPoint:t.anchorPoint,anchorPointUnits:t.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:t.rotateClockwise,rotation:0,size:t.size,billboardMode3D:t.billboardMode3D,depth3D:t.depth3D,frame:t.frame,markerGraphics:[i],scaleSymbolsProportionally:t.scaleSymbolsProportionally,respectFrame:t.respectFrame,clippingPath:t.clippingPath}}(t,o);let r=[];const u=["Rotation","OffsetX","OffsetY"];r=e.filter(j=>j.primitiveName!==t.primitiveName||-1===u.indexOf(j.propertyName));let b="";for(const j of e)void 0!==j.value&&(b+=`-${j.primitiveName}-${j.propertyName}-${JSON.stringify(j.value)}`);const[O,D,C]=v.B$.getTextureAnchor(_,c),Q=t.primitiveName,K=(0,s.NA)(t.rotation),F=(0,s.NA)(t.offsetX),ct=(0,s.NA)(t.offsetY),nt=(0,I.hP)(JSON.stringify(_)+b).toString(),tt={type:"marker",templateHash:nt,materialHash:0===r.length?nt:dt(nt,n,r,l),cim:_,materialOverrides:r,colorLocked:t.colorLocked,effects:i,scaleSymbolsProportionally:t.scaleSymbolsProportionally,alignment:f,anchorPoint:{x:O,y:D},isAbsoluteAnchorPoint:!1,size:t.size,rotation:a(Q,n,"Rotation",l,K),offsetX:a(Q,n,"OffsetX",l,F),offsetY:a(Q,n,"OffsetY",l,ct),color:{r:255,g:255,b:255,a:1},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:g,rotateClockwise:t.rotateClockwise,referenceSize:y,sizeRatio:C/(0,yt.F2)(t.size),markerPlacement:t.markerPlacement};h.push(tt)}function ht(t){if(t&&0===t.indexOf("Level_")){const i=parseInt(t.substr(6),10);if(NaN!==i)return i}return 0}function V(t){if(!t||0===t.length)return null;const i=new mt.Z(t).toRgba();return{r:i[0],g:i[1],b:i[2],a:i[3]}}function a(t,i,o,n,e,l,h){const c=i[t];if(c){const f=c[o];if("string"==typeof f||"number"==typeof f||f instanceof Array)return l?l.call(null,f,h):f;if(null!=f&&f instanceof pt.mz)return(y,g,_)=>{let r=(0,k.Z)(f,y,{$view:_},n.geometryType,g);return null!==r&&l&&(r=l.call(null,r,h)),null!==r?r:e}}return e}function dt(t,i,o,n){for(const e of o)if(e.valueExpressionInfo){const l=i[e.primitiveName]&&i[e.primitiveName][e.propertyName];l instanceof pt.mz&&(e.fn=(h,c,f)=>(0,k.Z)(l,h,{$view:f},n.geometryType,c))}return(e,l,h)=>{for(const c of o)c.fn&&(c.value=c.fn(e,l,h));return(0,I.hP)(t+v.E0.buildOverrideKey(o)).toString()}}function At(t,i){if(!i||0===i.length)return t;const o=JSON.parse(JSON.stringify(t));return v.E0.applyOverrides(o,i),o}function at(t,i){let o=!1,n="";for(const e of t)e.primitiveName===i&&(void 0!==e.value?n+=`-${e.primitiveName}-${e.propertyName}-${JSON.stringify(e.value)}`:e.valueExpressionInfo&&(o=!0));return[o,n]}function Xt(t,i,o){if(t&&i)switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const n=t.symbolLayers;if(!n)return;for(const e of n)switch(e.type){case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMCharacterMarker":case"CIMPictureMarker":"url"in e&&e.url&&o.push(i.fetchResource(e.url,null));break;case"CIMVectorMarker":{const l=e.markerGraphics;if(!l)continue;for(const h of l)if(h){const c=h.symbol;c&&Xt(c,i,o)}}}}}}const Jt=t=>t&&2===t.length&&t[0].enable&&t[1].enable&&"CIMSolidStroke"===t[0].type&&"CIMSolidFill"===t[1].type&&!t[0].effects&&!t[1].effects},73608:(ot,$,N)=>{N.d($,{j:()=>I});var lt=N(91179),mt=N(72283),it=N(29214),st=N(9631);class I{static executeEffects(v,E){const s=(0,mt.GP)(E);let k=new it.M(s);for(const J of v){const Z=(0,st.h)(J);Z&&(k=Z.execute(k,J,1.3333333333333333,!0))}return k}static next(v){const E=v.next();return(0,mt.wp)(E),E}static applyEffects(v,E){if(!v)return E;let s=new it.M(E);for(const J of v){const Z=(0,st.h)(J);Z&&(s=Z.execute(s,J,1,!1))}let R,k=null;for(;R=s.next();)k?(0,lt.l9)(k)?(0,lt.l9)(R)&&k.paths.push(...R.paths):(0,lt.oU)(k)&&(0,lt.oU)(R)&&k.rings.push(...R.rings):k=R;return k}}},39236:(ot,$,N)=>{N.d($,{Z:()=>st});var lt=N(26584),mt=N(63290),it=N(7848);function st(v,E,s,R,k){const J=v.referencesGeometry()&&k?function I(v,E,s){const{transform:R,hasZ:k,hasM:J}=s;yt.has(E)||yt.set(E,function pt(v){const E={};switch(v){case"esriGeometryPoint":return(s,R,k,J)=>(0,it.U1)(R,E,s,k,J);case"esriGeometryPolygon":return(s,R,k,J)=>(0,it.Ie)(R,E,s,k,J);case"esriGeometryPolyline":return(s,R,k,J)=>(0,it.G6)(R,E,s,k,J);case"esriGeometryMultipoint":return(s,R,k,J)=>(0,it.J9)(R,E,s,k,J);default:return mt.Z.getLogger("esri.views.2d.support.arcadeOnDemand").error(new lt.Z("mapview-arcade",`Unable to handle geometryType: ${v}`)),s=>s}}(E));const Z=yt.get(E)(v.geometry,R,k,J);return Et(kt({},v),{geometry:Z})}(E,R,k):E,Z=v.repurposeFeature(J);try{return v.evaluate(Et(kt({},s),{$feature:Z}))}catch(m){return mt.Z.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",m),null}}const yt=new Map}}]);