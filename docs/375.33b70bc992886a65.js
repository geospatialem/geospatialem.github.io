"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[375],{30375:(fe,O,l)=>{l.r(O),l.d(O,{destroyContext:()=>ee,dracoDecompressPointCloudData:()=>Q,filterObbsForModifications:()=>X,filterObbsForModificationsSync:()=>D,initialize:()=>E,interpretObbModificationResults:()=>te,process:()=>K,setLegacySchema:()=>q,setModifications:()=>k,setModificationsSync:()=>R,test:()=>ne});var P=l(15861),$=l(62208),f=l(55713),W=l(54346);function J(e){return(0,W.V)(`esri/libs/i3s/${e}`)}let T,L,r;function K(e){return w.apply(this,arguments)}function w(){return(w=(0,P.Z)(function*(e){yield E();const t=[e.geometryBuffer];return{result:C(e,t),transferList:t}})).apply(this,arguments)}function Q(e){return I.apply(this,arguments)}function I(){return(I=(0,P.Z)(function*(e){var t;yield E();const o=[e.geometryBuffer],{geometryBuffer:a}=e,s=a.byteLength,d=r._malloc(s),u=new Uint8Array(r.HEAPU8.buffer,d,s);u.set(new Uint8Array(a));const m=r.dracoDecompressPointCloudData(d,u.byteLength);if(r._free(d),m.error.length>0)throw`i3s.wasm: ${m.error}`;const h=(null==(t=m.featureIds)?void 0:t.length)>0?(0,f.tP)(m.featureIds):null,A=(0,f.tP)(m.positions);return h&&o.push(h.buffer),o.push(A.buffer),{result:{positions:A,featureIds:h},transferList:o}})).apply(this,arguments)}function X(e){return v.apply(this,arguments)}function v(){return(v=(0,P.Z)(function*(e){yield E(),D(e);const t={buffer:e.buffer};return{result:t,transferList:[t.buffer]}})).apply(this,arguments)}function k(e){return x.apply(this,arguments)}function x(){return(x=(0,P.Z)(function*(e){yield E(),R(e)})).apply(this,arguments)}function q(e){return F.apply(this,arguments)}function F(){return(F=(0,P.Z)(function*(e){yield E(),r.setLegacySchema(e.context,e.jsonSchema)})).apply(this,arguments)}function ee(e){N(e)}function R(e){const t=e.modifications,o=r._malloc(8*t.length),a=new Float64Array(r.HEAPU8.buffer,o,t.length);for(let s=0;s<t.length;++s)a[s]=t[s];r.setModifications(e.context,o,t.length,e.isGeodetic),r._free(o)}function C(e,t){if(!r)return null;const{context:o,localOrigin:a,globalTrafo:s,mbs:d,obb:u,elevationOffset:m,geometryBuffer:h,geometryDescriptor:A,indexToVertexProjector:re,vertexToRenderProjector:oe}=e,M=r._malloc(h.byteLength),S=r._malloc(33*Float64Array.BYTES_PER_ELEMENT),H=new Uint8Array(r.HEAPU8.buffer,M,h.byteLength);H.set(new Uint8Array(h));const i=new Float64Array(r.HEAPU8.buffer,S,33);g(i,a);let c=i.byteOffset+3*i.BYTES_PER_ELEMENT,y=new Float64Array(i.buffer,c);g(y,s),c+=16*i.BYTES_PER_ELEMENT,y=new Float64Array(i.buffer,c),g(y,d),c+=4*i.BYTES_PER_ELEMENT,(0,$.pC)(u)&&(y=new Float64Array(i.buffer,c),g(y,u.center),c+=3*i.BYTES_PER_ELEMENT,y=new Float64Array(i.buffer,c),g(y,u.halfSize),c+=3*i.BYTES_PER_ELEMENT,y=new Float64Array(i.buffer,c),g(y,u.quaternion));const Z=A,se={isDraco:!1,isLegacy:!1,color:e.layouts.some(b=>b.some(p=>"color"===p.name)),normal:e.needNormals&&e.layouts.some(b=>b.some(p=>"normalCompressed"===p.name)),uv0:e.layouts.some(b=>b.some(p=>"uv0"===p.name)),uvRegion:e.layouts.some(b=>b.some(p=>"uvRegion"===p.name)),featureIndex:Z.featureIndex},n=r.process(o,!!e.obb,M,H.byteLength,Z,se,S,m,re,oe,e.normalReferenceFrame);if(r._free(S),r._free(M),n.error.length>0)throw`i3s.wasm: ${n.error}`;if(n.discarded)return null;const U=n.componentOffsets.length>0?(0,f.tP)(n.componentOffsets):null,B=n.featureIds.length>0?(0,f.tP)(n.featureIds):null,j=(0,f.tP)(n.interleavedVertedData).buffer,V=(0,f.tP)(1===n.indicesType?new Uint16Array(n.indices.buffer,n.indices.byteOffset,n.indices.byteLength/2):new Uint32Array(n.indices.buffer,n.indices.byteOffset,n.indices.byteLength/4)),z=(0,f.tP)(n.positions),G=(0,f.tP)(1===n.positionIndicesType?new Uint16Array(n.positionIndices.buffer,n.positionIndices.byteOffset,n.positionIndices.byteLength/2):new Uint32Array(n.positionIndices.buffer,n.positionIndices.byteOffset,n.positionIndices.byteLength/4)),ie={layout:e.layouts[0],interleavedVertexData:j,indices:V,hasColors:n.hasColors,hasModifications:n.hasModifications,positionData:{data:z,indices:G}};return B&&t.push(B.buffer),U&&t.push(U.buffer),t.push(j),t.push(V.buffer),t.push(z.buffer),t.push(G.buffer),{componentOffsets:U,featureIds:B,transformedGeometry:ie,obb:n.obb}}function te(e){return 0===e?0:1===e?1:2===e?2:3}function D(e){const{context:t,buffer:o}=e,a=r._malloc(o.byteLength),s=o.byteLength/Float64Array.BYTES_PER_ELEMENT,d=new Float64Array(r.HEAPU8.buffer,a,s),u=new Float64Array(o);d.set(u),r.filterOBBs(t,a,s),u.set(d),r._free(a)}function N(e){r&&r.destroy(e)}function g(e,t){for(let o=0;o<t.length;++o)e[o]=t[o]}function E(){return r?Promise.resolve():(L||(L=function _(){return T||(T=new Promise(e=>l.e(5979).then(l.bind(l,85979)).then(t=>t.i).then(({default:t})=>{const o=t({locateFile:J,onRuntimeInitialized:()=>e(o)});delete o.then})).catch(e=>Promise.reject(e))),T}().then(e=>{r=e,L=null})),L)}const ne={transform:C,destroy:N}}}]);