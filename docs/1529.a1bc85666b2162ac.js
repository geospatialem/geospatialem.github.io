"use strict";var Ke=Object.defineProperty,We=Object.defineProperties,He=Object.getOwnPropertyDescriptors,Ue=Object.getOwnPropertySymbols,Je=Object.prototype.hasOwnProperty,Ge=Object.prototype.propertyIsEnumerable,Me=(G,V,l)=>V in G?Ke(G,V,{enumerable:!0,configurable:!0,writable:!0,value:l}):G[V]=l,ge=(G,V)=>{for(var l in V||(V={}))Je.call(V,l)&&Me(G,l,V[l]);if(Ue)for(var l of Ue(V))Ge.call(V,l)&&Me(G,l,V[l]);return G},Ee=(G,V)=>We(G,He(V));(self.webpackChunksite=self.webpackChunksite||[]).push([[1529,3100,9530],{83100:(G,V,l)=>{function d(g){return g=g||globalThis.location.hostname,F.some(E=>{var M;return null!=(null==(M=g)?void 0:M.match(E))})}function p(g,E){return g&&(E=E||globalThis.location.hostname)?null!=E.match(f)||null!=E.match(v)?g.replace("static.arcgis.com","staticdev.arcgis.com"):null!=E.match(m)||null!=E.match(h)?g.replace("static.arcgis.com","staticqa.arcgis.com"):g:g}l.d(V,{pJ:()=>p,XO:()=>d});const f=/^devext.arcgis.com$/,m=/^qaext.arcgis.com$/,v=/^[\w-]*\.mapsdevext.arcgis.com$/,h=/^[\w-]*\.mapsqa.arcgis.com$/,F=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,f,m,/^jsapps.esri.com$/,v,h]},7848:(G,V,l)=>{l.d(V,{ym:()=>ee,RF:()=>le,vY:()=>h,J9:()=>fe,U1:()=>ye,Ie:()=>ce,G6:()=>ve});var d=l(62208),p=l(91179);const f=(a,o,c)=>[o,c],m=(a,o,c)=>[o,c,a[2]],v=(a,o,c)=>[o,c,a[2],a[3]];function h(a){return a?{originPosition:"upper-left"===a.originPosition?"upperLeft":"lower-left"===a.originPosition?"lowerLeft":a.originPosition,scale:a.tolerance?[a.tolerance,a.tolerance]:[1,1],translate:(0,d.pC)(a.extent)?[a.extent.xmin,a.extent.ymax]:[0,0]}:null}function g({scale:a,translate:o},c){return Math.round((c-o[0])/a[0])}function E({scale:a,translate:o},c){return Math.round((o[1]-c)/a[1])}function M(a,o,c){const x=[];let b,K,N,W;for(let re=0;re<c.length;re++){const ie=c[re];re>0?(N=g(a,ie[0]),W=E(a,ie[1]),N===b&&W===K||(x.push(o(ie,N-b,W-K)),b=N,K=W)):(b=g(a,ie[0]),K=E(a,ie[1]),x.push(o(ie,b,K)))}return x.length>0?x:null}function R({scale:a,translate:o},c){return c*a[0]+o[0]}function y({scale:a,translate:o},c){return o[1]-c*a[1]}function A(a,o,c){const x=new Array(c.length);if(!c.length)return x;const[b,K]=a.scale;let N=R(a,c[0][0]),W=y(a,c[0][1]);x[0]=o(c[0],N,W);for(let re=1;re<c.length;re++){const ie=c[re];N+=ie[0]*b,W-=ie[1]*K,x[re]=o(ie,N,W)}return x}function ue(a,o,c){const x=new Array(c.length);for(let b=0;b<c.length;b++)x[b]=A(a,o,c[b]);return x}function le(a,o,c,x,b){return o.x=g(a,c.x),o.y=E(a,c.y),o!==c&&(x&&(o.z=c.z),b&&(o.m=c.m)),o}function ee(a,o){return a&&o?(0,p.wp)(o)?le(a,{},o,!1,!1):(0,p.l9)(o)?function B(a,o,c,x,b){const K=function X(a,o,c,x){const b=[],K=c?x?v:m:x?m:f;for(let N=0;N<o.length;N++){const W=M(a,K,o[N]);W&&W.length>=2&&b.push(W)}return b.length?b:null}(a,c.paths,x,b);return K?(o.paths=K,o):null}(a,{},o,!1,!1):(0,p.oU)(o)?function de(a,o,c,x,b){const K=function T(a,o,c,x){const b=[],K=c?x?v:m:x?m:f;for(let N=0;N<o.length;N++){const W=M(a,K,o[N]);W&&W.length>=3&&b.push(W)}return b.length?b:null}(a,c.rings,x,b);return K?(o.rings=K,o):null}(a,{},o,!1,!1):(0,p.aW)(o)?function H(a,o,c,x,b){return o.points=function $(a,o,c,x){return M(a,c?x?v:m:x?m:f,o)}(a,c.points,x,b),o}(a,{},o,!1,!1):(0,p.YX)(o)?function k(a,o,c,x,b){return o.xmin=g(a,c.xmin),o.ymin=E(a,c.ymin),o.xmax=g(a,c.xmax),o.ymax=E(a,c.ymax),o!==c&&(x&&(o.zmin=c.zmin,o.zmax=c.zmax),b&&(o.mmin=c.mmin,o.mmax=c.mmax)),o}(a,{},o,!1,!1):null:null}function fe(a,o,c,x,b){return(0,d.pC)(c)&&(o.points=function _e(a,o,c,x){return A(a,c?x?v:m:x?m:f,o)}(a,c.points,x,b)),o}function ye(a,o,c,x,b){return(0,d.Wi)(c)||(o.x=R(a,c.x),o.y=y(a,c.y),o!==c&&(x&&(o.z=c.z),b&&(o.m=c.m))),o}function ce(a,o,c,x,b){return(0,d.pC)(c)&&(o.rings=function Q(a,o,c,x){return ue(a,c?x?v:m:x?m:f,o)}(a,c.rings,x,b)),o}function ve(a,o,c,x,b){return(0,d.pC)(c)&&(o.paths=function pe(a,o,c,x){return ue(a,c?x?v:m:x?m:f,o)}(a,c.paths,x,b)),o}},22264:(G,V,l)=>{function d(v,h){return h?"xoffset"in h&&h.xoffset?Math.max(v,Math.abs(h.xoffset)):"yoffset"in h&&h.yoffset?Math.max(v,Math.abs(h.yoffset||0)):v:v}function Z(v,h){return"number"==typeof v?v:v&&v.stops&&v.stops.length?function p(v){let h=0,F=0;for(let g=0;g<v.length;g++){const E=v[g].size;"number"==typeof E&&(h+=E,F++)}return h/F}(v.stops):h}function m(v){const h=v&&v.renderer,F="touch"===(v&&v.event&&v.event.pointerType)?9:6;if(!h)return F;const g="visualVariables"in h?function f(v,h){if(!h)return v;const F=h.filter(z=>"size"===z.type).map(z=>{const{maxSize:$,minSize:T}=z;return(Z($,v)+Z(T,v))/2});let g=0;const E=F.length;if(0===E)return v;for(let z=0;z<E;z++)g+=F[z];const M=Math.floor(g/E);return Math.max(M,v)}(F,h.visualVariables):F;if("simple"===h.type)return d(g,h.symbol);if("unique-value"===h.type){let E=g;return h.uniqueValueInfos.forEach(M=>{E=d(E,M.symbol)}),E}if("class-breaks"===h.type){let E=g;return h.classBreakInfos.forEach(M=>{E=d(E,M.symbol)}),E}return g}l.d(V,{k:()=>m})},25310:(G,V,l)=>{l.d(V,{a:()=>v});var d=l(26584),p=l(63290),Z=l(39406),f=l(64288);const m=p.Z.getLogger("esri.views.2d.engine.webgl");function v(h){return(0,f.hj)(h.minDataValue)&&(0,f.hj)(h.maxDataValue)&&null!=h.minSize&&null!=h.maxSize?Z.X.SIZE_MINMAX_VALUE:(h.expression&&"view.scale"===h.expression||h.valueExpression&&"$view.scale"===h.valueExpression)&&Array.isArray(h.stops)?Z.X.SIZE_SCALE_STOPS:(null!=h.field||h.expression&&"view.scale"!==h.expression||h.valueExpression&&"$view.scale"!==h.valueExpression)&&(Array.isArray(h.stops)||"levels"in h&&h.levels)?Z.X.SIZE_FIELD_STOPS:(null!=h.field||h.expression&&"view.scale"!==h.expression||h.valueExpression&&"$view.scale"!==h.valueExpression)&&null!=h.valueUnit?Z.X.SIZE_UNIT_VALUE:(m.error(new d.Z("mapview-bad-type","Found invalid size VisualVariable",h)),Z.X.NONE)}},68915:(G,V,l)=>{l.r(V),l.d(V,{default:()=>ze});var g,d=l(15861),p=l(17626),Z=l(88879),f=l(77712),v=(l(85931),l(8314)),F=(l(90912),l(76898));let E=g=class extends Z.Z{constructor(){super(...arguments),this.isAggregate=!0}getEffectivePopupTemplate(e=!1){if(this.popupTemplate)return this.popupTemplate;const r=this.sourceLayer&&this.sourceLayer.featureReduction;return r&&"popupTemplate"in r&&r.popupEnabled?r.popupTemplate:null}getObjectId(){return this.objectId}clone(){return new g(ge({objectId:this.objectId},this.cloneProperties()))}};(0,p._)([(0,f.Cb)({type:Boolean})],E.prototype,"isAggregate",void 0),(0,p._)([(0,f.Cb)({type:Number,json:{read:!0}})],E.prototype,"objectId",void 0),E=g=(0,p._)([(0,F.j)("esri.AggregateGraphic")],E);const M=E;l(29132);var $=l(7093),T=l(26584),X=l(58817),R=l(63290),y=l(62208),A=l(10699),ue=l(32917),ne=l(27e3),_e=l(14517),pe=l(52884);let Q=class extends _e.Z{constructor(e){super(e),this._filter=null,this.duration=(0,v.Z)("mapview-transitions-duration"),this._excludedEffectView=new pe.ZP(e),this._includedEffectView=new pe.ZP(e)}get excludedEffects(){return this._excludedEffectView.effects}set featureEffect(e){this._get("featureEffect")!==e&&this._transitionTo(e)}get filter(){var e;return this._filter||(null==(e=(0,y.Wg)(this.featureEffect))?void 0:e.filter)||null}get hasEffects(){return this._excludedEffectView.hasEffects||this._includedEffectView.hasEffects}get includedEffects(){return this._includedEffectView.effects}set scale(e){this._set("scale",e),this._excludedEffectView.scale=e,this._includedEffectView.scale=e}get transitioning(){return this._excludedEffectView.transitioning||this._includedEffectView.transitioning}transitionStep(e,r){this._set("scale",r),this.transitioning?(this._includedEffectView.transitionStep(e,r),this._excludedEffectView.transitionStep(e,r),this.transitioning||(this._filter=null)):(this._excludedEffectView.scale=r,this._includedEffectView.scale=r)}end(){this._includedEffectView.end(),this._excludedEffectView.end(),this._filter=null}_transitionTo(e){const r=this._get("featureEffect"),i=(0,y.Wg)(e),s=(0,y.Wg)(null==i?void 0:i.includedEffect),u=(0,y.Wg)(null==i?void 0:i.excludedEffect),_=this._includedEffectView.canTransitionTo(s)&&this._excludedEffectView.canTransitionTo(u);this._includedEffectView.effect=s,this._excludedEffectView.effect=u,this._set("featureEffect",i),this._filter=(null==i?void 0:i.filter)||(null==r?void 0:r.filter)||null,_||this.end()}};(0,p._)([(0,f.Cb)()],Q.prototype,"_filter",void 0),(0,p._)([(0,f.Cb)()],Q.prototype,"_excludedEffectView",void 0),(0,p._)([(0,f.Cb)()],Q.prototype,"_includedEffectView",void 0),(0,p._)([(0,f.Cb)()],Q.prototype,"duration",void 0),(0,p._)([(0,f.Cb)()],Q.prototype,"excludedEffects",null),(0,p._)([(0,f.Cb)()],Q.prototype,"featureEffect",null),(0,p._)([(0,f.Cb)()],Q.prototype,"filter",null),(0,p._)([(0,f.Cb)()],Q.prototype,"hasEffects",null),(0,p._)([(0,f.Cb)()],Q.prototype,"includedEffects",null),(0,p._)([(0,f.Cb)({value:0})],Q.prototype,"scale",null),(0,p._)([(0,f.Cb)()],Q.prototype,"transitioning",null),Q=(0,p._)([(0,F.j)("esri.layers.effects.FeatureEffectView")],Q);const he=Q;var U=l(98624),O=l(22264),L=l(17253),j=l(84952),k=l(39351),H=l(37384),le=l(23997);function B(){return(B=(0,d.Z)(function*(e,r){if(!e)return null;switch(e.type){case"class-breaks":case"simple":case"unique-value":case"dot-density":case"dictionary":return new((yield Promise.all([l.e(7692),l.e(3070),l.e(4589),l.e(4056),l.e(8592),l.e(3036)]).then(l.bind(l,19268))).default)(r);case"heatmap":return new((yield Promise.all([l.e(7692),l.e(3070),l.e(4589),l.e(8592),l.e(2900)]).then(l.bind(l,32900))).default)(r)}})).apply(this,arguments)}var ee=l(44316),J=l(62192),fe=l(71251);function ye(e){return e.some(r=>r.globalId)}function ce(e){return e.filter(r=>!r.error).map(r=>{var i;return null!=(i=r.objectId)?i:r.globalId})}function ve(e,r){const i=new Set(e);for(const s of r.values())i.add(s);return i}function a(e,r){const i=new Set(e);for(const s of r.values())i.delete(s);return i}let o=class extends _e.Z{constructor(e){super(e),this._hasGlobalIds=!1}normalizeCtorArgs(e){return this._queueProcessor=new fe.e({concurrency:1,process:e.process}),{}}destroy(){this._queueProcessor.clear()}get updating(){return this._queueProcessor.length>0}push(e){const r=this._queueProcessor,i=r.last();switch(e.type){case"update":case"refresh":if((null==i?void 0:i.type)===e.type)return;r.push(e).finally(()=>this.notifyChange("updating"));break;case"edit":{const s="processed-edit"===(null==i?void 0:i.type)?i:null;s&&r.popLast();const u=this._mergeEdits(s,e);for(const _ of u)r.push(_).finally(()=>this.notifyChange("updating"));break}}this.notifyChange("updating")}_mergeEdits(e,r){var i,s;const{addedFeatures:u,deletedFeatures:_,updatedFeatures:C}=r.edits;if(this._hasGlobalIds=this._hasGlobalIds||ye(u)||ye(C)||ye(_),this._hasGlobalIds)return[e,{type:"processed-edit",edits:{addOrModified:[...u,...C],removed:_}}];const P=new Set(ce(null!=(i=null==e?void 0:e.edits.addOrModified)?i:[])),I=new Set(ce(null!=(s=null==e?void 0:e.edits.removed)?s:[])),w=new Set([...ce(u),...ce(C)]),S=new Set(ce(_));return[{type:"processed-edit",edits:{addOrModified:Array.from(ve(a(P,S),w)).map(D=>({objectId:D})),removed:Array.from(ve(a(I,w),S)).map(D=>({objectId:D}))}}]}};(0,p._)([(0,f.Cb)({readOnly:!0})],o.prototype,"updating",null),o=(0,p._)([(0,F.j)("esri.views.2d.layers.support.FeatureCommandQueue")],o);const c=o;var x=l(60330),b=l(59289);let N=class extends x.D{constructor(e){super(e),this._startupResolver=(0,A.hh)(),this.isReady=!1}initialize(){this._controller=new AbortController,this.addResolvingPromise(this._startWorker(this._controller.signal))}destroy(){this._controller.abort(),this._connection&&this._connection.close()}set tileRenderer(e){this.client.tileRenderer=e}get closed(){return this._connection.closed}startup(e,r,i,s){var u=this;return(0,d.Z)(function*(){yield u.when();const _=u._controller.signal,C=function K(e){return Array.isArray(e)}(i.source)?{transferList:i.source,signal:_}:void 0,P={service:i,config:r,tileInfo:e.tileInfo.toJSON(),tiles:s};yield u._connection.invoke("startup",P,C),u._startupResolver.resolve(),u._set("isReady",!0)})()}updateTiles(e){var r=this;return(0,d.Z)(function*(){return yield r._startupResolver.promise,(0,A.R8)(r._connection.invoke("updateTiles",e))})()}update(e){var r=this;return(0,d.Z)(function*(){const i={config:e};return yield r._startupResolver.promise,r._connection.invoke("update",i)})()}applyUpdate(e){var r=this;return(0,d.Z)(function*(){return yield r._startupResolver.promise,r._connection.invoke("applyUpdate",e)})()}setHighlight(e){var r=this;return(0,d.Z)(function*(){return yield r._startupResolver.promise,(0,A.R8)(r._connection.invoke("controller.setHighlight",e))})()}refresh(e){var r=this;return(0,d.Z)(function*(){return yield r._startupResolver.promise,(0,A.R8)(r._connection.invoke("controller.refresh",e))})()}querySummaryStatistics(e,r,i){var s=this;return(0,d.Z)(function*(){return yield s._startupResolver.promise,s._connection.invoke("controller.querySummaryStatistics",{query:e.toJSON(),params:r},i)})()}queryUniqueValues(e,r,i){var s=this;return(0,d.Z)(function*(){return yield s._startupResolver.promise,s._connection.invoke("controller.queryUniqueValues",{query:e.toJSON(),params:r},i)})()}queryClassBreaks(e,r,i){var s=this;return(0,d.Z)(function*(){return yield s._startupResolver.promise,s._connection.invoke("controller.queryClassBreaks",{query:e.toJSON(),params:r},i)})()}queryHistogram(e,r,i){var s=this;return(0,d.Z)(function*(){return yield s._startupResolver.promise,s._connection.invoke("controller.queryHistogram",{query:e.toJSON(),params:r},i)})()}queryFeatures(e,r){var i=this;return(0,d.Z)(function*(){return yield i._startupResolver.promise,i._connection.invoke("controller.queryFeatures",e.toJSON(),r)})()}queryVisibleFeatures(e,r){var i=this;return(0,d.Z)(function*(){return yield i._startupResolver.promise,i._connection.invoke("controller.queryVisibleFeatures",e.toJSON(),r)})()}queryObjectIds(e,r){var i=this;return(0,d.Z)(function*(){return yield i._startupResolver.promise,i._connection.invoke("controller.queryObjectIds",e.toJSON(),r)})()}queryFeatureCount(e,r){var i=this;return(0,d.Z)(function*(){return yield i._startupResolver.promise,i._connection.invoke("controller.queryFeatureCount",e.toJSON(),r)})()}queryExtent(e,r){var i=this;return(0,d.Z)(function*(){return i._connection.invoke("controller.queryExtent",e.toJSON(),r)})()}queryLatestObservations(e,r){var i=this;return(0,d.Z)(function*(){return yield i._startupResolver.promise,i._connection.invoke("controller.queryLatestObservations",e.toJSON(),r)})()}queryStatistics(e){var r=this;return(0,d.Z)(function*(){return yield r._startupResolver.promise,r._connection.invoke("controller.queryStatistics",e)})()}getObjectId(e){var r=this;return(0,d.Z)(function*(){return yield r._startupResolver.promise,r._connection.invoke("controller.getObjectId",e)})()}getDisplayId(e){var r=this;return(0,d.Z)(function*(){return yield r._startupResolver.promise,r._connection.invoke("controller.getDisplayId",e)})()}getFeatures(e){var r=this;return(0,d.Z)(function*(){return yield r._startupResolver.promise,r._connection.invoke("controller.getFeatures",e)})()}getAggregates(){var e=this;return(0,d.Z)(function*(){return yield e._startupResolver.promise,e._connection.invoke("controller.getAggregates")})()}getAggregateValueRanges(){var e=this;return(0,d.Z)(function*(){return yield e._startupResolver.promise,e._connection.invoke("controller.getAggregateValueRanges")})()}mapValidDisplayIds(e){var r=this;return(0,d.Z)(function*(){return yield r._startupResolver.promise,r._connection.invoke("controller.mapValidDisplayIds",e)})()}onEdits(e){var r=this;return(0,d.Z)(function*(){return yield r._startupResolver.promise,(0,A.R8)(r._connection.invoke("controller.onEdits",e))})()}enableEvent(e,r){var i=this;return(0,d.Z)(function*(){return yield i._startupResolver.promise,(0,A.R8)(i._connection.invoke("controller.enableEvent",{name:e,value:r}))})()}_startWorker(e){var r=this;return(0,d.Z)(function*(){try{r._connection=yield(0,b.bA)("Pipeline",{client:r.client,strategy:"dedicated",signal:e})}catch(i){(0,A.H9)(i)}})()}};(0,p._)([(0,f.Cb)()],N.prototype,"isReady",void 0),(0,p._)([(0,f.Cb)()],N.prototype,"client",void 0),(0,p._)([(0,f.Cb)()],N.prototype,"tileRenderer",null),N=(0,p._)([(0,F.j)("esri.views.2d.layers.support.FeatureLayerProxy")],N);const W=N;var re=l(43930),ie=l(84378),xe=l(58098);class we{constructor(r){this._tiles=new Map,this.buffer=0,this.acquireTile=r.acquireTile,this.releaseTile=r.releaseTile,this.tileInfoView=r.tileInfoView,this.buffer=r.buffer}destroy(){}clear(){this._tiles.forEach(r=>this._releaseTile(r))}tileKeys(){const r=[];return this._tiles.forEach((i,s)=>r.push(s)),r}update(r){const i=this.tileInfoView.getTileCoverage(r.state,this.buffer,"closest"),{spans:s,lodInfo:u}=i,{level:_}=u,C=[],P=[],I=new Set,w=new Set;for(const{row:S,colFrom:D,colTo:Y}of s)for(let q=D;q<=Y;q++){const oe=xe.Z.getId(_,S,u.normalizeCol(q),u.getWorldForColumn(q)),ae=this._getOrAcquireTile(C,oe);I.add(oe),ae.isReady?ae.visible=!0:w.add(ae.key)}return w.forEach(S=>this._addPlaceholders(I,S)),this._tiles.forEach(S=>{I.has(S.key.id)||(P.push(S.key.id),this._releaseTile(S))}),ie.Z.pool.release(i),{hasMissingTiles:w.size>0,added:C,removed:P}}_getOrAcquireTile(r,i){if(!this._tiles.has(i)){const s=this.acquireTile(new xe.Z(i));r.push(i),this._tiles.set(i,s),s.visible=!1}return this._tiles.get(i)}_getTile(r){return this._tiles.get(r)}_releaseTile(r){this._tiles.delete(r.key.id),this.releaseTile(r)}_addPlaceholders(r,i){const s=this._addPlaceholderChildren(r,i);Math.abs(1-s)<1e-6||this._addPlaceholderParent(r,i)||(this._getTile(i.id).visible=!0)}_addPlaceholderChildren(r,i){let s=0;return this._tiles.forEach(u=>{s+=this._addPlaceholderChild(r,u,i)}),s}_addPlaceholderChild(r,i,s){return i.key.level<=s.level||!i.hasData||!s.contains(i.key)?0:(i.visible=!0,r.add(i.key.id),1/(1<<2*(i.key.level-s.level)))}_addPlaceholderParent(r,i){let s=i.getParentKey(),u=0,_=null;for(;(0,y.pC)(s);){if(r.has(s.id))return!0;const C=this._getTile(s.id);if(null!=C&&C.isReady)return C.visible=!0,r.add(C.key.id),!0;null!=C&&C.hasData&&C.patchCount>u&&(u=C.patchCount,_=C),s=s.getParentKey()}return!!_&&(_.visible=!0,r.add(_.key.id),!0)}}var Pe=l(55538),Ve=l(55400),Ze=l(2319),te=l(36630),Le=l(46679),Re=l(10023),Se=l(79530);const Ie=R.Z.getLogger("esri.views.layers.FeatureLayerView"),De=e=>{let r=class extends e{constructor(...i){super(...i),this._updatingRequiredFieldsPromise=null,this.filter=null,this.timeExtent=null,this.layer=null,this.requiredFields=[],this.view=null}initialize(){(0,ne.S1)(this,["layer.renderer","layer.labelingInfo","layer.elevationInfo.featureExpressionInfo","layer.displayField","filter","featureEffect","layer.timeInfo","layer.floorInfo","timeExtent"],()=>this._handleRequiredFieldsChange(),!0),(0,ne.on)(this,"view.floors","change",()=>this._handleRequiredFieldsChange()),(0,ne.on)(this,"layer.sublayer","change",()=>this._handleRequiredFieldsChange())}get availableFields(){const{layer:i,layer:{fieldsIndex:s},requiredFields:u}=this;return(0,te.Q0)(s,"outFields"in i&&i.outFields?[...(0,te.Lk)(s,i.outFields),...u]:u)}set effect(i){(0,Pe.Mr)(Ie,"effect",{replacement:"featureEffect",version:"4.22"}),this.featureEffect=i}get effect(){return(0,Pe.Mr)(Ie,"effect",{replacement:"featureEffect",version:"4.22"}),this.featureEffect}get featureEffect(){return this.layer&&"featureEffect"in this.layer?this.layer.featureEffect:null}set featureEffect(i){void 0!==i?this._override("featureEffect",i):this._clearOverride("featureEffect")}get maximumNumberOfFeatures(){return 0}set maximumNumberOfFeatures(i){Ie.error("#maximumNumberOfFeatures=","Setting maximum number of features is not supported")}get maximumNumberOfFeaturesExceeded(){return!1}highlight(i){throw new Error("missing implementation")}createQuery(){const i={outFields:["*"],returnGeometry:!0,outSpatialReference:this.view.spatialReference},s=(0,y.pC)(this.filter)?this.filter.createQuery(i):new j.Z(i);if("feature"===this.layer.type){const u=(0,Se.cx)(this);(0,y.pC)(u)&&(s.where=s.where?`(${s.where}) AND (${u})`:u)}return(0,y.pC)(this.timeExtent)&&(s.timeExtent=(0,y.pC)(s.timeExtent)?s.timeExtent.intersection(this.timeExtent):this.timeExtent.clone()),s}queryFeatures(i,s){throw new Error("missing implementation")}queryObjectIds(i,s){throw new Error("missing implementation")}queryFeatureCount(i,s){throw new Error("missing implementation")}queryExtent(i,s){throw new Error("missing implementation")}fetchPopupFeatures(i,s){var u=this;return(0,d.Z)(function*(){const _=u.validateFetchPopupFeatures(s);if(_)throw _;return u.fetchClientPopupFeatures(s)})()}_loadArcadeModules(i){if(i.get("expressionInfos.length")||Array.isArray(i.content)&&i.content.some(s=>"expression"===s.type))return(0,Le.LC)()}_handleRequiredFieldsChange(){const i=this._updateRequiredFields();this._set("_updatingRequiredFieldsPromise",i),i.then(()=>{this._updatingRequiredFieldsPromise===i&&this._set("_updatingRequiredFieldsPromise",null)})}_updateRequiredFields(){var i=this;return(0,d.Z)(function*(){if(!i.layer||!i.view)return;const s="3d"===i.view.type,{layer:u,layer:{fieldsIndex:_,objectIdField:C}}=i,P="renderer"in u&&u.renderer,I="orderBy"in u&&u.orderBy,w=u.featureReduction,S=new Set,D=yield(0,A.as)([P?P.collectRequiredFields(S,_):null,(0,te.Mu)(S,u),s?(0,te.vl)(S,u):null,(0,y.pC)(i.filter)?(0,te.Ll)(S,u,i.filter):null,(0,y.pC)(i.featureEffect)?(0,te.Ll)(S,u,i.featureEffect.filter):null,w?(0,te.ZV)(S,u,w):null,I?(0,te.Qj)(S,u,I):null]);if(u.timeInfo&&i.timeExtent&&(0,te.gd)(S,u.fieldsIndex,[u.timeInfo.startField,u.timeInfo.endField]),"feature"===u.type&&u.floorInfo&&(0,te.gd)(S,u.fieldsIndex,[u.floorInfo.floorField]),"subtype-group"===u.type){(0,te.AB)(S,_,u.subtypeField);const q=u.sublayers.map(oe=>{var ae;return Promise.all([null==(ae=oe.renderer)?void 0:ae.collectRequiredFields(S,_),(0,te.Mu)(S,oe)])});yield(0,A.as)(q)}for(const q of D)q.error&&Ie.error(q.error);(0,te.AB)(S,_,C),s&&"displayField"in u&&u.displayField&&(0,te.AB)(S,_,u.displayField);const Y=Array.from(S).sort();i._set("requiredFields",Y)})()}validateFetchPopupFeatures(i){if((0,y.Wi)(i))return null;for(const s of i.clientGraphics){const u=s.layer;if("popupEnabled"in u&&!u.popupEnabled)return new T.Z("featurelayerview:fetchPopupFeatures","Popups are disabled",{layer:u});if("popupTemplate"in u&&!(0,Re.V)(u,i))return new T.Z("featurelayerview:fetchPopupFeatures","Layer does not define a popup template",{layer:u});if(s.isAggregate&&!(u.featureReduction&&"popupTemplate"in u.featureReduction&&u.featureReduction.popupEnabled&&u.featureReduction.popupTemplate))return new T.Z("featurelayerview:fetchPopupFeatures","Popups are disabled",{layer:u})}}fetchClientPopupFeatures(i){var s=this;return(0,d.Z)(function*(){const u=(0,y.pC)(i)?i.clientGraphics:null;if(!u||0===u.length)return[];const _=new Array(u.length),C=new Map,P=yield s.createPopupQuery(i);for(let I=0;I<u.length;I++){const w=u[I];if(w.isAggregate){_[I]=w;continue}const{layer:S}=w;if(!("popupEnabled"in S))continue;const D=(0,te.Lk)(s.layer.fieldsIndex,P.outFields),Y=(0,Re.V)(S,i);if(!(0,y.pC)(Y))continue;const q=yield s._loadArcadeModules(Y);q&&q.arcadeUtils.hasGeometryOperations(Y)||!(0,te.R9)(D,w)?C.set(w.getObjectId(),I):_[I]=w}if("stream"===s.layer.type||0===C.size)return _.filter(Boolean);P.objectIds=Array.from(C.keys());try{const I=yield s.layer.queryFeatures(P);for(const w of I.features)_[C.get(w.getObjectId())]=w}catch(I){}return _.filter(Boolean)})()}createPopupQuery(i){var s=this;return(0,d.Z)(function*(){const u=s.layer.createQuery(),_=new Set;let C=!1;const P=(0,y.pC)(i)&&i.clientGraphics?i.clientGraphics.map(I=>I.layer):[s.layer];for(const I of P){if(!("popupEnabled"in I))continue;const w=(0,Re.V)(I,i);if(!(0,y.pC)(w))continue;const S=yield s._loadArcadeModules(w),D=S&&S.arcadeUtils.hasGeometryOperations(w);C=!("point"!==s.layer.geometryType&&!D);const Y=yield(0,Re.e)(s.layer,w);for(const q of Y)_.add(q)}if(u.returnGeometry=C,u.returnZ=C,u.returnM=C,u.outFields=Array.from(_),u.outSpatialReference=s.view.spatialReference,"feature"===s.layer.type){const I=(0,Se.cx)(s);(0,y.pC)(I)&&(u.where=u.where?`(${u.where}) AND (${I})`:I)}return u})()}canResume(){return!(!super.canResume()||(0,y.pC)(this.timeExtent)&&this.timeExtent.isEmpty)}};return(0,p._)([(0,f.Cb)()],r.prototype,"_updatingRequiredFieldsPromise",void 0),(0,p._)([(0,f.Cb)({readOnly:!0})],r.prototype,"availableFields",null),(0,p._)([(0,f.Cb)()],r.prototype,"effect",null),(0,p._)([(0,f.Cb)({type:Ze.Z})],r.prototype,"featureEffect",null),(0,p._)([(0,f.Cb)({type:U.Z})],r.prototype,"filter",void 0),(0,p._)([(0,f.Cb)(Ve.qG)],r.prototype,"timeExtent",void 0),(0,p._)([(0,f.Cb)()],r.prototype,"layer",void 0),(0,p._)([(0,f.Cb)({type:Number})],r.prototype,"maximumNumberOfFeatures",null),(0,p._)([(0,f.Cb)({readOnly:!0,type:Boolean})],r.prototype,"maximumNumberOfFeaturesExceeded",null),(0,p._)([(0,f.Cb)({readOnly:!0})],r.prototype,"requiredFields",void 0),(0,p._)([(0,f.Cb)()],r.prototype,"suspended",void 0),(0,p._)([(0,f.Cb)()],r.prototype,"view",void 0),r=(0,p._)([(0,F.j)("esri.views.layers.FeatureLayerView")],r),r};var Ae=l(45611),je=l(94421),Ne=l(94672),Fe=l(31637),Be=l(2004);function Te(e){return e&&"openPorts"in e}const Ce=R.Z.getLogger("esri.views.2d.layers.FeatureLayerView2D");let se=class extends(De((0,je.y)((0,H.y)(Ae.Z)))){constructor(){var e;super(...arguments),e=this,this._pipelineIsUpdating=!0,this._commandsQueue=new c({process:r=>{switch(r.type){case"processed-edit":return this._doEdit(r);case"refresh":return this._doRefresh(r.dataChanged);case"update":return this._doUpdate()}}}),this._visibilityOverrides=new Set,this._highlightIds=new Map,this._lastPixelBuffer=0,this._updateHighlight=(0,A.Ds)((0,d.Z)(function*(){return e._proxy.setHighlight(Array.from(e._highlightIds.keys()))})),this._uploadsLocked=!1,this._needsClusterSizeUpdate=!1,this.featureEffectView=new he,this._lastDefinitionExpression=null}destroy(){var e,r;(0,y.Po)(this._updateClusterSizeTask,i=>i.remove()),null==(e=this._proxy)||e.destroy(),null==(r=this.tileRenderer)||r.destroy(),this._commandsQueue.destroy()}initialize(){this.addResolvingPromise(Promise.all([this._initProxy(),this._initServiceOptions()])),this.handles.add([this.on("valueRangesChanged",e=>{this._set("_aggregateValueRanges",e.valueRanges)}),(0,ue.Ym)(()=>this.featureEffect,e=>{this.featureEffectView.featureEffect=e},{initial:!0,sync:!0})])}_initProxy(){var e=this;return(0,d.Z)(function*(){if("isTable"in e.layer&&e.layer.isTable)throw new T.Z("featurelayerview:table-not-supported","table feature layer can't be displayed",{layer:e.layer});e._proxy&&e._proxy.destroy();const r=e._createClientOptions();return e._set("_proxy",new W({client:r})),e._proxy.when()})()}_initServiceOptions(){var e=this;return(0,d.Z)(function*(){e._set("_serviceOptions",yield e._createServiceOptions())})()}get orderByFields(){return"stream"!==this._serviceOptions.type&&this._serviceOptions.orderByFields}get labelsVisible(){return!this.suspended&&("subtype-group"===this.layer.type?this.layer.sublayers.items:[this.layer]).some(r=>r.labelingInfo&&r.labelsVisible)}get queryMode(){return this._serviceOptions.type}get renderingConfigHash(){if(!this.layer)return null;const e=this.availableFields,r=this.layer,i=this.view.floors,{definitionExpression:s}=r,u="subtype-group"!==this.layer.type&&this.layer.labelsVisible&&this.layer.labelingInfo,_="renderer"in r&&r.renderer,C="feature"===r.type?r.gdbVersion:void 0,P="feature"===r.type&&r.historicMoment?r.historicMoment.getTime():void 0,{timeExtent:I}=this,w="customParameters"in r?JSON.stringify(r.customParameters):void 0,S="apiKey"in r?r.apiKey:void 0,D="stream"===r.type?`${JSON.stringify(r.geometryDefinition)}${r.definitionExpression}`:null,Y=JSON.stringify(this.clips),q=r.featureReduction&&r.featureReduction.toJSON(),oe="orderBy"in this.layer&&JSON.stringify(this.layer.orderBy),ae="sublayers"in this.layer&&this.layer.sublayers.items.reduce((Oe,me)=>Oe+`${me.visible?1:0}.${JSON.stringify(me.renderer)}.${me.labelsVisible}\n.${JSON.stringify(me.labelingInfo)}`,"");return JSON.stringify({orderBy:oe,sublayerHash:ae,filterHash:(0,y.pC)(this.filter)&&this.filter.toJSON(),effectHash:(0,y.pC)(this.featureEffect)&&this.featureEffect.toJSON(),streamFilter:D,gdbVersion:C,definitionExpression:s,historicMoment:P,availableFields:e,renderer:_,labelingInfo:u,timeExtent:I,floors:i,clipsHash:Y,featureReduction:q,customParameters:w,apiKey:S})}fetchPopupFeatures(e,r){var i=()=>super.fetchPopupFeatures,s=this;return(0,d.Z)(function*(){var u;if((0,y.pC)(r)&&0===r.clientGraphics.length)return[];if("cluster"!==(null==(u=s.layer.featureReduction)?void 0:u.type)){const _=(0,O.k)({renderer:"renderer"in s.layer&&s.layer.renderer,event:(0,y.pC)(r)&&r.event}),C=(0,Ne.K)(e,_,s.view),{features:P}=yield s.queryVisibleFeatures(new j.Z({geometry:C,outFields:["*"],returnGeometry:!0}));r=(0,y.pC)(r)?r:{};const I=new Set(r.clientGraphics.map(w=>w.getObjectId()));for(const w of P)I.has(w.getObjectId())||r.clientGraphics.push(w)}return i().call(s,e,r)})()}highlight(e){var r;let i;return e instanceof Z.Z?i=[e.getObjectId()]:"number"==typeof e||"string"==typeof e?i=[e]:Array.isArray(e)&&e.length>0?i="number"==typeof e[0]||"string"==typeof e[0]?e:e.map(s=>null==s?void 0:s.getObjectId()):$.Z.isCollection(e)&&e.length>0&&(i=e.map(s=>null==s?void 0:s.getObjectId()).toArray()),i=null==(r=i)?void 0:r.filter(s=>null!=s),i&&i.length?(this._addHighlight(i),{remove:()=>this._removeHighlight(i)}):{remove:()=>{}}}hasHighlight(){return!!this._highlightIds.size}hitTest(e,r){var i=this;return(0,d.Z)(function*(){if(!i.tileRenderer)return null;const s=yield i.tileRenderer.hitTest(r);if(0===s.length)return null;const{features:u,aggregates:_}=yield i._proxy.getFeatures(s);return[..._.map(C=>i._createHittestResult(M.fromJSON(C))),...u.map(C=>i._createHittestResult(Z.Z.fromJSON(C)))]})()}queryAggregates(){var e=this;return(0,d.Z)(function*(){return(yield e._proxy.getAggregates()).map(r=>M.fromJSON(r))})()}queryStatistics(){return this._proxy.queryStatistics()}querySummaryStatistics(e,r,i){var s=this;return(0,d.Z)(function*(){const u=Ee(ge({},r),{scale:s.view.scale});return s._proxy.querySummaryStatistics(s._cleanUpQuery(e),u,i)})()}queryUniqueValues(e,r,i){var s=this;return(0,d.Z)(function*(){const u=Ee(ge({},r),{scale:s.view.scale});return s._proxy.queryUniqueValues(s._cleanUpQuery(e),u,i)})()}queryClassBreaks(e,r,i){var s=this;return(0,d.Z)(function*(){const u=Ee(ge({},r),{scale:s.view.scale});return s._proxy.queryClassBreaks(s._cleanUpQuery(e),u,i)})()}queryHistogram(e,r,i){var s=this;return(0,d.Z)(function*(){const u=Ee(ge({},r),{scale:s.view.scale});return s._proxy.queryHistogram(s._cleanUpQuery(e),u,i)})()}queryFeatures(e,r){return this.queryFeaturesJSON(e,r).then(i=>{const s=L.default.fromJSON(i);return s.features.forEach(u=>this._setLayersForFeature(u)),s})}queryVisibleFeatures(e,r){return this._proxy.queryVisibleFeatures(this._cleanUpQuery(e),r).then(i=>{const s=L.default.fromJSON(i);return s.features.forEach(u=>this._setLayersForFeature(u)),s})}queryFeaturesJSON(e,r){return this._proxy.queryFeatures(this._cleanUpQuery(e),r)}queryObjectIds(e,r){return this._proxy.queryObjectIds(this._cleanUpQuery(e),r)}queryFeatureCount(e,r){return this._proxy.queryFeatureCount(this._cleanUpQuery(e),r)}queryExtent(e,r){return this._proxy.queryExtent(this._cleanUpQuery(e),r).then(i=>({count:i.count,extent:Be.Z.fromJSON(i.extent)}))}setVisibility(e,r){r?this._visibilityOverrides.delete(e):this._visibilityOverrides.add(e),this._update()}update(e){if(!this._tileStrategy||!this.tileRenderer)return;const{hasMissingTiles:r,added:i,removed:s}=this._tileStrategy.update(e);(i.length||s.length)&&this._proxy.updateTiles({added:i,removed:s}),r&&this.requestUpdate(),this.notifyChange("updating")}attach(){this.view.timeline.record(`${this.layer.title} (FeatureLayer) Attach`),this._tileStrategy=new we({acquireTile:e=>this._acquireTile(e),releaseTile:e=>this._releaseTile(e),tileInfoView:this.view.featuresTilingScheme,buffer:0}),this.handles.add((0,ne.S1)(this,"renderingConfigHash",()=>this._update()),"attach"),"stream"!==this.layer.type&&this.handles.add(this.layer.on("edits",e=>this._edit(e)),"attach")}detach(){this.container.removeAllChildren(),this.handles.remove("attach"),this.tileRenderer&&(this.tileRenderer.uninstall(this.container),this.tileRenderer=null),this._tileStrategy&&(this._tileStrategy.destroy(),this._tileStrategy=null),this._tileRendererHash=null}moveStart(){this.requestUpdate()}viewChange(){this.requestUpdate()}moveEnd(){this.requestUpdate()}isUpdating(){var e;const r="renderer"in this.layer&&null!=this.layer.renderer,i=this._commandsQueue.updating,s=null!=this._updatingRequiredFieldsPromise,u=!this._proxy||!this._proxy.isReady,_=this._pipelineIsUpdating,C=null===this.tileRenderer||(null==(e=this.tileRenderer)?void 0:e.updating),P=r&&(i||s||u||_||C);return(0,v.Z)("esri-2d-log-updating")&&console.log(`Updating FLV2D: ${P}\n  -> hasRenderer ${r}\n  -> hasPendingCommand ${i}\n  -> updatingRequiredFields ${s}\n  -> updatingProxy ${u}\n  -> updatingPipeline ${_}\n  -> updatingTileRenderer ${C}\n`),P}_createClientOptions(){return{setUpdating:e=>{this._set("_pipelineIsUpdating",e)},emitEvent:e=>{this.emit(e.name,e.event)}}}_detectQueryMode(e){var r=this;return(0,d.Z)(function*(){var i;const u="editingInfo"in r.layer&&(null==(i=r.layer.editingInfo)?void 0:i.lastEditDate);if("path"in e&&("feature"===r.layer.type||"subtype-group"===r.layer.type)&&"point"===r.layer.geometryType&&r.layer.capabilities.query.supportsPagination&&!r.layer.capabilities.operations.supportsEditing&&(u||!r.layer.refreshInterval)&&(0,v.Z)("featurelayer-snapshot-enabled"))try{const P=yield r.layer.queryFeatureCount();if(P<=(0,v.Z)("featurelayer-snapshot-point-min-threshold"))return{mode:"snapshot",featureCount:P};const I=(0,v.Z)("featurelayer-snapshot-point-max-threshold"),w=(0,v.Z)("featurelayer-snapshot-point-coverage"),S=r.view.extent,D=(0,y.Wg)(r.layer.fullExtent),Y=null==D?void 0:D.clone().intersection(S),q=(0,y.pC)(Y)?Y.width*Y.height:0,oe=(null==D?void 0:D.width)*(null==D?void 0:D.height),ae=0===oe?0:q/oe;if(P<=I&&ae>=w)return{mode:"snapshot",featureCount:P}}catch(P){Ce.warn("mapview-feature-layer","Encountered an error when querying for featureCount",{error:P})}return{mode:"on-demand"}})()}_createServiceOptions(){var e=this;return(0,d.Z)(function*(){var r;const i=e.layer;if("stream"===i.type)return null;const{capabilities:s,objectIdField:u}=i,_=i.fields.map(me=>me.toJSON()),C=(0,y.pC)(i.fullExtent)&&i.fullExtent.toJSON(),P=(0,re.oq)(i.geometryType),I=i.timeInfo&&i.timeInfo.toJSON()||null,w=i.spatialReference?i.spatialReference.toJSON():null,S="feature"===i.type?i.globalIdField:null;let D;"ogc-feature"===i.type?D=i.source.getFeatureDefinition():Te(i.source)?D=yield i.source.openPorts():i.parsedUrl&&(D=(0,X.d9)(i.parsedUrl),"dynamicDataSource"in i&&i.dynamicDataSource&&(D.query={layer:JSON.stringify({source:i.dynamicDataSource})}));const Y="datesInUnknownTimezone"in e.layer&&e.layer.datesInUnknownTimezone,q=null!=(r="subtypeField"in e.layer&&e.layer.subtypeField)?r:null,{mode:oe,featureCount:ae}=yield e._detectQueryMode(D);let Oe=e.layer.objectIdField;if("feature"===e.layer.type&&(0,y.pC)(e.layer.orderBy)&&e.layer.orderBy.length){const me=!e.layer.orderBy[0].valueExpression&&e.layer.orderBy[0].field;me&&(Oe=me)}return{type:oe,timeReferenceUnknownClient:Y,subtypeField:q,featureCount:ae,globalIdField:S,maxRecordCount:s.query.maxRecordCount,tileMaxRecordCount:s.query.tileMaxRecordCount,capabilities:s,fields:_,fullExtent:C,geometryType:P,objectIdField:u,source:D,timeInfo:I,spatialReference:w,orderByFields:Oe}})()}_createMemoryServiceOptions(e){var r=this;return(0,d.Z)(function*(){const i=yield e.openPorts();return Ee(ge({},r._createServiceOptions()),{type:"memory",source:i})})()}_cleanUpQuery(e){const r=j.Z.from(e)||this.createQuery();return r.outSpatialReference||(r.outSpatialReference=this.view.spatialReference),r}_update(){var e=this;return(0,d.Z)(function*(){return e._commandsQueue.push({type:"update"})})()}_edit(e){var r=this;return(0,d.Z)(function*(){if(r._validateEdit(e))return r._commandsQueue.push({type:"edit",edits:e})})()}doRefresh(e){var r=this;return(0,d.Z)(function*(){return r._commandsQueue.push({type:"refresh",dataChanged:e})})()}_validateEdit(e){const r="globalIdField"in this.layer&&this.layer.globalIdField,i=e.deletedFeatures.some(u=>-1===u.objectId||!u.objectId),s=r&&this.availableFields.includes(r);return i&&!s?(Ce.error(new T.Z("mapview-apply-edits",`Editing the specified service requires the layer's globalIdField, ${r} to be included the layer's outFields for updates to be reflected on the map`)),null):e}_doUpdate(){var e=this;return(0,d.Z)(function*(){try{if(e.destroyed||!e._hasRequiredSupport(e.layer)||!e._tileStrategy)return;const{featureEffectView:r,filter:i}=e;yield e._updateRequiredFields();const{renderer:s}=e._getEffectiveRenderer();e._set("_effectiveRenderer",s);const u=e._createSchemaConfig(),_=(0,re.oq)(e.layer.geometryType),C=yield(0,ee.G)(s,_,e.view.resourceManager,e.layer.fields,e.layer.spatialReference,e.layer.featureReduction),P=e._createConfiguration(u,i,r.filter),I=e._lastDefinitionExpression!==P.definitionExpression;e._lastDefinitionExpression=P.definitionExpression,e._lastPixelBuffer=0===C?0:Math.max(C,e._lastPixelBuffer),P.schema.source.pixelBuffer=e._lastPixelBuffer;const w=e._createTileRendererHash(s);if("snapshot"===e._serviceOptions.type&&(P.schema.source.featureCount=e._serviceOptions.featureCount),w!==e._tileRendererHash){yield e._initTileRenderer(s);const S=e._serviceOptions;e.tileRenderer.onConfigUpdate(s);const D=e.layer;"stream"!==D.type&&Te(D.source)&&(S.source=yield D.source.openPorts()),"stream"===D.type&&(yield e._initServiceOptions());const Y={added:e._tileStrategy.tileKeys(),removed:[]};yield e._proxy.startup(e.view.featuresTilingScheme,P,S,Y),e.hasHighlight()&&(yield e._proxy.setHighlight(Array.from(e._highlightIds.keys()))),yield e._onceTilesUpdated(),e.tileRenderer.onConfigUpdate(s)}else{"snapshot"===e._serviceOptions.type&&I&&(P.schema.source.featureCount=yield e.layer.queryFeatureCount());const S=yield e._proxy.update(P);(S.mesh||S.targets.aggregate)&&e._lockGPUUploads();try{yield e._proxy.applyUpdate(S)}catch(D){(0,A.D_)(D)||Ce.error(D)}(S.mesh||S.targets.aggregate)&&e._unlockGPUUploads(),e.tileRenderer.onConfigUpdate(s),e._updateClusterSizeVariable(),e._forceAttributeTextureUpload()}e._tileRendererHash=w,e.tileRenderer.invalidateLabels(),e.requestUpdate()}catch(r){}})()}_doEdit(e){var r=this;return(0,d.Z)(function*(){try{yield r._proxy.onEdits(e)}catch(i){(0,A.D_)(i)}})()}_doRefresh(e){var r=this;return(0,d.Z)(function*(){r._lockGPUUploads();try{yield r._proxy.refresh(e)}catch(i){(0,A.D_)(i)}r._unlockGPUUploads()})()}_updateClusterSizeVariable(){this._needsClusterSizeUpdate&&(this.tileRenderer.onConfigUpdate(this._effectiveRenderer),this._needsClusterSizeUpdate=!1)}_createUpdateClusterSizeTask(e,r){var i=this;return this.watch("_aggregateValueRanges",function(){var s=(0,d.Z)(function*(u){i._updateClusterEffectiveRendererSizeVariable(e,r,u),i._needsClusterSizeUpdate=!0,i._uploadsLocked||i._updateClusterSizeVariable()});return function(u){return s.apply(this,arguments)}}())}_updateClusterEffectiveRendererSizeVariable(e,r,i){var s=this;return(0,d.Z)(function*(){if(e.dynamicClusterSize&&"visualVariables"in e&&e.visualVariables){const u=(0,J.os)(e.visualVariables);if((0,y.pC)(u)&&"cluster_count"===u.field){const _=e.visualVariables.indexOf(u);e.visualVariables[_]=(0,J.aV)(r,i);const C=e.clone();C.dynamicClusterSize=!0,s._set("_effectiveRenderer",C)}}})()}_getEffectiveRenderer(){const e="renderer"in this.layer&&this.layer.renderer,r=this.layer.featureReduction;if((0,y.pC)(this._updateClusterSizeTask)&&(this._updateClusterSizeTask.remove(),this._updateClusterSizeTask=null),r&&"cluster"===r.type&&(0,J.yR)(e)){const i=r,s=[],u=(0,J.S1)(s,e,i,this._aggregateValueRanges);return(0,y.Po)(this._updateClusterSizeTask,_=>_.remove()),this._updateClusterSizeTask=this._createUpdateClusterSizeTask(u,i),{renderer:u,aggregateFields:s,featureReduction:r}}return{renderer:e,aggregateFields:[],featureReduction:null}}_acquireTile(e){const r=this.tileRenderer.acquireTile(e);return r.once("attach",()=>{this.requestUpdate()}),r}_releaseTile(e){this.tileRenderer.releaseTile(e)}_initTileRenderer(e){var r=this;return(0,d.Z)(function*(){const i=yield function de(e,r){return B.apply(this,arguments)}(e,{layerView:r,tileInfoView:r.view.featuresTilingScheme,layer:r.layer});return r.tileRenderer&&(r._tileStrategy.clear(),r.tileRenderer.uninstall(r.container),r.tileRenderer.destroy(),r.tileRenderer=null),r.destroyed?null:(r._proxy.tileRenderer=i,r._set("tileRenderer",i),r.tileRenderer.install(r.container),r.tileRenderer.onConfigUpdate(e),r.requestUpdate(),r.tileRenderer)})()}_createTileRendererHash(e){return`${"heatmap"===e.type?"heatmap":"symbol"}.${"dot-density"===e.type}`}get hasFilter(){return!!(this.filter||"floorInfo"in this.layer&&this.layer.floorInfo&&this.view.floors&&this.view.floors.length||this._visibilityOverrides.size||this.timeExtent)}_injectOverrides(e){const r=(0,y.pC)(e)?e.timeExtent:null,i=(0,y.pC)(this.timeExtent)&&(0,y.pC)(r)?this.timeExtent.intersection(r):this.timeExtent||r;let s=null;const u="floorInfo"in this.layer&&this.layer.floorInfo;if(u){const C=(0,y.pC)(e)&&e.where;s=this._addFloorFilterClause(C)}if(!this._visibilityOverrides.size&&!i&&!u)return(0,y.pC)(e)?e.toJSON():null;(e=(0,y.pC)(e)&&e.clone()||new U.Z).timeExtent=i,s&&(e.where=s);const _=e.toJSON();return _.hiddenIds=Array.from(this._visibilityOverrides),_}_addFloorFilterClause(e){const r=this.layer;let i=e||"";if("floorInfo"in r&&r.floorInfo){var s;let u=this.view.floors;if(!u||!u.length)return i;null!=(s=r.floorInfo.viewAllLevelIds)&&s.length&&(u=r.floorInfo.viewAllLevelIds);const _=u.filter(I=>""!==I).map(I=>"'"+I+"'");_.push("''");const C=r.floorInfo.floorField;let P="("+C+" IN ({ids}) OR "+C+" IS NULL)";if(P=P.replace("{ids}",_.join(", ")),(0,y.pC)(i)&&i.includes(C)){let I=new RegExp("AND \\("+C+".*NULL\\)","g");i=i.replace(I,""),I=new RegExp("\\("+C+".*NULL\\)","g"),i=i.replace(I,""),i=i.replace(/\s+/g," ").trim()}i=""!==i?"("+i+") AND "+P:P}return""!==i?i:null}_createConfiguration(e,r,i){const s="feature"===this.layer.type&&this.layer.historicMoment?this.layer.historicMoment.getTime():void 0,u="feature"===this.layer.type?this.layer.gdbVersion:void 0,_=new Array(k.m4),C=this._injectOverrides(r);_[0]=C,_[1]=(0,y.pC)(i)?i.toJSON():null;const P=(0,le.createSchema)(e);if((0,y.Wi)(P))return null;const I=(0,Fe.Z)();return{definitionExpression:this.layer.definitionExpression,availableFields:this.availableFields,gdbVersion:u,historicMoment:s,devicePixelRatio:window.devicePixelRatio||1,filters:_,schema:P,supportsTextureFloat:I.supportsTextureFloat,maxTextureSize:I.maxTextureSize}}_hasRequiredSupport(e){var r;return!("renderer"in e&&"dot-density"===(null==(r=e.renderer)?void 0:r.type)&&!(0,Fe.Z)().supportsTextureFloat&&(Ce.error(new T.Z("webgl-missing-extension","Missing WebGL extension OES_Texture_Float which is required for DotDensity")),1))}_onceTilesUpdated(){return this.requestUpdate(),(0,ne.OY)(this,"_pipelineIsUpdating",!1)}_lockGPUUploads(){this.tileRenderer&&(this._uploadsLocked=!0,this.tileRenderer.lockGPUUploads())}_unlockGPUUploads(){this.tileRenderer&&(this._uploadsLocked=!1,this.tileRenderer.unlockGPUUploads())}_forceAttributeTextureUpload(){this.tileRenderer&&this.tileRenderer.forceAttributeTextureUpload()}_createSchemaConfig(){return{renderer:"renderer"in this.layer&&this.layer.renderer,spatialReference:this.layer.spatialReference,timeExtent:this.layer.timeExtent,definitionExpression:this.layer.definitionExpression,featureReduction:this.layer.featureReduction,fields:this.layer.fields,geometryType:this.layer.geometryType,historicMoment:"feature"===this.layer.type?this.layer.historicMoment:null,labelsVisible:"labelsVisible"in this.layer&&this.layer.labelsVisible,labelingInfo:"labelingInfo"in this.layer&&this.layer.labelingInfo,availableFields:this.availableFields,featureEffect:this.featureEffect,filter:this.filter,gdbVersion:"feature"===this.layer.type?this.layer.gdbVersion:null,pixelBuffer:0,orderBy:"orderBy"in this.layer&&this.layer.orderBy?this.layer.orderBy:null,customParameters:Ee(ge({},"customParameters"in this.layer?this.layer.customParameters:void 0),{token:"apiKey"in this.layer?this.layer.apiKey:void 0})}}_addHighlight(e){for(const r of e)if(this._highlightIds.has(r)){const i=this._highlightIds.get(r);this._highlightIds.set(r,i+1)}else this._highlightIds.set(r,1);this._updateHighlight().catch(r=>{(0,A.D_)(r)||Ce.error(r)})}_removeHighlight(e){for(const r of e)if(this._highlightIds.has(r)){const i=this._highlightIds.get(r)-1;0===i?this._highlightIds.delete(r):this._highlightIds.set(r,i)}this._updateHighlight().catch(r=>{(0,A.D_)(r)||Ce.error(r)})}_setLayersForFeature(e){const r=this.layer;e.layer=r,e.sourceLayer=r}_createHittestResult(e){return this._setLayersForFeature(e),(0,y.pC)(e.geometry)&&(e.geometry.spatialReference=this.view.spatialReference),e}};(0,p._)([(0,f.Cb)()],se.prototype,"_serviceOptions",void 0),(0,p._)([(0,f.Cb)()],se.prototype,"_proxy",void 0),(0,p._)([(0,f.Cb)()],se.prototype,"_pipelineIsUpdating",void 0),(0,p._)([(0,f.Cb)()],se.prototype,"_effectiveRenderer",void 0),(0,p._)([(0,f.Cb)()],se.prototype,"_aggregateValueRanges",void 0),(0,p._)([(0,f.Cb)()],se.prototype,"_commandsQueue",void 0),(0,p._)([(0,f.Cb)()],se.prototype,"featureEffectView",void 0),(0,p._)([(0,f.Cb)()],se.prototype,"labelsVisible",null),(0,p._)([(0,f.Cb)({readOnly:!0})],se.prototype,"queryMode",null),(0,p._)([(0,f.Cb)()],se.prototype,"renderingConfigHash",null),(0,p._)([(0,f.Cb)()],se.prototype,"tileRenderer",void 0),(0,p._)([(0,f.Cb)()],se.prototype,"updating",void 0),se=(0,p._)([(0,F.j)("esri.views.2d.layers.FeatureLayerView2D")],se);const ze=se},37384:(G,V,l)=>{l.d(V,{y:()=>le});var d=l(17626),p=l(7093),Z=l(89726),f=l(27e3),m=l(77712),g=(l(85931),l(8314),l(90912),l(76898)),E=l(1011),M=l(86162);l(63290),l(82255);let T=class extends M.wq{};T=(0,d._)([(0,g.j)("esri.views.layers.support.ClipArea")],T);const X=T;var R;let y=R=class extends X{constructor(){super(...arguments),this.type="rect",this.left=null,this.right=null,this.top=null,this.bottom=null}clone(){return new R({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}get version(){return(this._get("version")||0)+1}};(0,d._)([(0,m.Cb)({type:[Number,String],json:{write:!0}})],y.prototype,"left",void 0),(0,d._)([(0,m.Cb)({type:[Number,String],json:{write:!0}})],y.prototype,"right",void 0),(0,d._)([(0,m.Cb)({type:[Number,String],json:{write:!0}})],y.prototype,"top",void 0),(0,d._)([(0,m.Cb)({type:[Number,String],json:{write:!0}})],y.prototype,"bottom",void 0),(0,d._)([(0,m.Cb)({readOnly:!0})],y.prototype,"version",null),y=R=(0,d._)([(0,g.j)("esri.views.layers.support.ClipRect")],y);const A=y;l(29132);var he,ne=l(21674),_e=l(91179),pe=l(2004),Q=l(37118);const U={base:ne.Z,key:"type",typeMap:{extent:pe.Z,polygon:Q.Z}};let O=he=class extends X{constructor(){super(...arguments),this.type="geometry",this.geometry=null}get version(){return(this._get("version")||0)+1}clone(){return new he({geometry:this.geometry.clone()})}};(0,d._)([(0,m.Cb)({types:U,json:{read:_e.im,write:!0}})],O.prototype,"geometry",void 0),(0,d._)([(0,m.Cb)({readOnly:!0})],O.prototype,"version",null),O=he=(0,d._)([(0,g.j)("esri.views.layers.support.Geometry")],O);const L=O;let j=class extends X{constructor(){super(...arguments),this.type="path",this.path=[]}get version(){return(this._get("version")||0)+1}};(0,d._)([(0,m.Cb)({type:[[[Number]]],json:{write:!0}})],j.prototype,"path",void 0),(0,d._)([(0,m.Cb)({readOnly:!0})],j.prototype,"version",null),j=(0,d._)([(0,g.j)("esri.views.layers.support.Path")],j);const H=p.Z.ofType({key:"type",base:X,typeMap:{rect:A,path:j,geometry:L}}),le=de=>{let B=class extends de{constructor(){super(...arguments),this.clips=new H,this.moving=!1,this.attached=!1,this.lastUpdateId=-1,this.updateRequested=!1}initialize(){var ee;this.container||(this.container=new E.W),this.container.fadeTransitionEnabled=!0,this.container.opacity=0,this.container.clips=this.clips,this.handles.add([(0,f.S1)(this,"suspended",J=>{this.container&&(this.container.visible=!J),this.view&&!J&&this.updateRequested&&this.view.requestUpdate()},!0),(0,f.S1)(this,["layer.opacity","container"],()=>{var J,fe;this.container&&(this.container.opacity=null!=(J=null==(fe=this.layer)?void 0:fe.opacity)?J:1)},!0),(0,f.S1)(this,["layer.blendMode"],J=>{this.container&&(this.container.blendMode=J)},!0),(0,f.S1)(this,["layer.effect"],J=>{this.container&&(this.container.effect=J)},!0),this.clips.on("change",()=>{this.container.clips=this.clips,this.notifyChange("clips")})]),null!=(ee=this.view)&&ee.whenLayerView?this.view.whenLayerView(this.layer).then(J=>{J!==this||this.attached||this.destroyed||(this.attach(),this.requestUpdate(),this.attached=!0)},()=>{}):this.when().then(()=>{this.attached||this.destroyed||(this.attach(),this.requestUpdate(),this.attached=!0)},()=>{})}destroy(){this.attached&&(this.detach(),this.attached=!1),this.handles.remove("initialize"),this.updateRequested=!1}get updating(){return!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!(!this.updatingHandles||!this.updatingHandles.updating)}isVisibleAtScale(ee){let J=!0;const fe=this.layer,ye=fe.minScale,ce=fe.maxScale;if(null!=ye&&null!=ce){let ve=!ye,a=!ce;!ve&&ee<=ye&&(ve=!0),!a&&ee>=ce&&(a=!0),J=ve&&a}return J}requestUpdate(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())}processUpdate(ee){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",ee),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(ee))):this.updateRequested=!1}hitTest(ee,J){return Promise.resolve(null)}isUpdating(){return!1}isRendering(){return!1}canResume(){return!!super.canResume()&&this.isVisibleAtScale(this.view.scale)}};return(0,d._)([(0,m.Cb)({type:H,set(ee){const J=(0,Z.Z)(ee,this._get("clips"),H);this._set("clips",J)}})],B.prototype,"clips",void 0),(0,d._)([(0,m.Cb)()],B.prototype,"moving",void 0),(0,d._)([(0,m.Cb)()],B.prototype,"attached",void 0),(0,d._)([(0,m.Cb)()],B.prototype,"container",void 0),(0,d._)([(0,m.Cb)()],B.prototype,"suspended",void 0),(0,d._)([(0,m.Cb)({readOnly:!0})],B.prototype,"updateParameters",void 0),(0,d._)([(0,m.Cb)()],B.prototype,"updateRequested",void 0),(0,d._)([(0,m.Cb)()],B.prototype,"updating",null),(0,d._)([(0,m.Cb)()],B.prototype,"view",void 0),B=(0,d._)([(0,g.j)("esri.views.2d.layers.LayerView2D")],B),B}},11263:(G,V,l)=>{l.d(V,{xS:()=>he,B3:()=>Q});var d=l(15861),p=l(84175),Z=l(39406),f=l(18716);const m={marker:Z.LW.MARKER,fill:Z.LW.FILL,line:Z.LW.LINE,text:Z.LW.TEXT};class v{constructor(O,L,j,k){const H={minScale:null==L?void 0:L.minScale,maxScale:null==L?void 0:L.maxScale},le=function h(U){return U.minScale||U.maxScale?U.minScale+"-"+U.maxScale:""}(H);this.layers=O,this.data=L,this.hash=this._createHash()+le,this.rendererKey=j;const de={isOutline:!1,isOutlinedFill:!1,placement:null,stride:{fill:"default"},vvFlags:j};for(const B of O)B.materialKey=(0,f.jj)(m[B.type],de),B.maxVVSize=k,B.scaleInfo=H,B.templateHash+=le}get type(){return"expanded-cim"}_createHash(){let O="";for(const L of this.layers)O+=L.templateHash;return O}}var F=l(83100),g=l(26584),E=l(10699),M=l(21726),z=l(84687),$=l(29840),T=l(78241);function X(U,O,L){return R.apply(this,arguments)}function R(){return(R=(0,d.Z)(function*(U,O,L){if(!U.name)return Promise.reject(new g.Z("style-symbol-reference-name-missing","Missing name in style symbol reference"));if(U.styleName&&"Esri2DPointSymbolsStyle"===U.styleName)return y(U,L);try{return ue(yield(0,T.n2)(U,O,L),U.name,O,L)}catch(j){return(0,E.k_)(j),null}})).apply(this,arguments)}function y(U,O){return A.apply(this,arguments)}function A(){return(A=(0,d.Z)(function*(U,O){const L=T.wm.replace(/\{SymbolName\}/gi,U.name);try{const j=yield(0,T.EJ)(L,O);return(0,T.KV)(j.data)}catch(j){return(0,E.k_)(j),null}})).apply(this,arguments)}function ue(U,O,L,j){return ne.apply(this,arguments)}function ne(){return(ne=(0,d.Z)(function*(U,O,L,j){const k=U.data,H={portal:L&&L.portal||z.Z.getDefault(),url:(0,M.mN)(U.baseUrl),origin:"portal-item"},le=k.items.find(B=>B.name===O);if(!le)throw new g.Z("symbolstyleutils:symbol-name-not-found",`The symbol name '${O}' could not be found`,{symbolName:O});let de=(0,$.f)((0,T.v9)(le,"cimRef"),H);(0,F.XO)()&&(de=(0,F.pJ)(de));try{const B=yield(0,T.EJ)(de,j);return(0,T.KV)(B.data)}catch(B){return(0,E.k_)(B),null}})).apply(this,arguments)}const pe=function(){var U=(0,d.Z)(function*(O,L,j){return new v(yield(0,p.c)(O.data,L,j),O.data,O.rendererKey,O.maxVVSize)});return function(L,j,k){return U.apply(this,arguments)}}(),Q=function(){var U=(0,d.Z)(function*(O,L,j,k){if(!O)return null;if("cim"===O.type)return pe(O,L,j);if("web-style"===O.type){const H={type:"cim",data:yield X(O,null,k),rendererKey:O.rendererKey,maxVVSize:O.maxVVSize};return pe(H,L,j)}return O});return function(L,j,k,H){return U.apply(this,arguments)}}();function he(U){if(!U)return null;const{type:O,cim:L,url:j,materialHash:k}=U,H={cim:L,type:O,mosaicHash:k,url:j,size:null,dashTemplate:null,path:null,text:null,fontName:null};switch(O){case"marker":H.size=U.size,H.path=U.path;break;case"line":H.dashTemplate=U.dashTemplate;break;case"text":H.text=U.text,H.fontName=U.fontName}return H}},45611:(G,V,l)=>{l.d(V,{Z:()=>X});var d=l(17626),p=l(14517),Z=l(61885),f=l(80542),m=l(61996),v=l(63290),h=l(62208),F=l(60330),g=l(77712),$=(l(85931),l(8314),l(90912),l(76898));let T=class extends((0,f.p)((0,m.I)((0,F.v)(Z.Z.EventedMixin(p.Z))))){constructor(R){super(R),this.layer=null,this.parent=null}initialize(){this.when().catch(R=>{if("layerview:create-error"!==R.name){const y=this.layer&&this.layer.id||"no id",A=this.layer&&this.layer.title||"no title";throw v.Z.getLogger(this.declaredClass).error("#resolve()",`Failed to resolve layer view (layer title: '${A}', id: '${y}')`,R),R}})}get fullOpacity(){return(0,h.Pt)(this.get("layer.opacity"),1)*(0,h.Pt)(this.get("parent.fullOpacity"),1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer.legendEnabled}get updating(){return!!(this.updatingHandles&&this.updatingHandles.updating||this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){var R;return!0===(null==(R=this.layer)?void 0:R.visible)}set visible(R){void 0!==R?this._override("visible",R):this._clearOverride("visible")}canResume(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.get("layer.loaded")&&this.visible||!1}getSuspendInfo(){const R=this.parent&&this.parent.suspended?this.parent.suspendInfo:{};return this.view&&this.view.ready||(R.viewNotReady=!0),this.layer&&this.layer.loaded||(R.layerNotLoaded=!0),this.visible||(R.layerInvisible=!0),R}isUpdating(){return!1}};(0,d._)([(0,g.Cb)()],T.prototype,"fullOpacity",null),(0,d._)([(0,g.Cb)()],T.prototype,"layer",void 0),(0,d._)([(0,g.Cb)()],T.prototype,"parent",void 0),(0,d._)([(0,g.Cb)({readOnly:!0})],T.prototype,"suspended",null),(0,d._)([(0,g.Cb)({readOnly:!0})],T.prototype,"suspendInfo",null),(0,d._)([(0,g.Cb)({readOnly:!0})],T.prototype,"legendEnabled",null),(0,d._)([(0,g.Cb)({type:Boolean,readOnly:!0})],T.prototype,"updating",null),(0,d._)([(0,g.Cb)({readOnly:!0})],T.prototype,"updatingProgress",null),(0,d._)([(0,g.Cb)()],T.prototype,"visible",null),T=(0,d._)([(0,$.j)("esri.views.layers.LayerView")],T);const X=T},94421:(G,V,l)=>{l.d(V,{y:()=>E});var d=l(17626),p=l(63290),Z=l(10699),f=l(27e3),m=l(77712),g=(l(85931),l(8314),l(90912),l(76898));const E=M=>{let z=class extends M{initialize(){this.handles.add((0,f.on)(this,"layer","refresh",$=>{this.doRefresh($.dataChanged).catch(T=>{(0,Z.D_)(T)||p.Z.getLogger(this.declaredClass).error(T)})}),"RefreshableLayerView")}};return(0,d._)([(0,m.Cb)()],z.prototype,"layer",void 0),z=(0,d._)([(0,g.j)("esri.layers.mixins.RefreshableLayerView")],z),z}},10023:(G,V,l)=>{l.d(V,{V:()=>v,e:()=>f});var d=l(15861),p=l(62208),Z=l(36630);function f(h){return m.apply(this,arguments)}function m(){return(m=(0,d.Z)(function*(h,F=h.popupTemplate){if(!(0,p.pC)(F))return[];const g=yield F.getRequiredFields(h.fieldsIndex),{lastEditInfoEnabled:E}=F,{objectIdField:M,typeIdField:z,globalIdField:$,relationships:T}=h;if(g.includes("*"))return["*"];const X=E?yield(0,Z.CH)(h):[],R=(0,Z.Q0)(h.fieldsIndex,[...g,...X]);return z&&R.push(z),R&&M&&h.fieldsIndex.has(M)&&-1===R.indexOf(M)&&R.push(M),R&&$&&h.fieldsIndex.has($)&&-1===R.indexOf($)&&R.push($),T&&T.forEach(y=>{const{keyField:A}=y;R&&A&&h.fieldsIndex.has(A)&&-1===R.indexOf(A)&&R.push(A)}),R})).apply(this,arguments)}function v(h,F){return h.popupTemplate?h.popupTemplate:(0,p.pC)(F)&&F.defaultPopupTemplateEnabled&&(0,p.pC)(h.defaultPopupTemplate)?h.defaultPopupTemplate:null}},94672:(G,V,l)=>{l.d(V,{K:()=>m}),l(29132);var p=l(62208),Z=l(16730),f=l(2004);function m(F,g,E,M=new f.Z){let z;if("2d"===E.type)z=g*E.resolution;else if("3d"===E.type){const A=E.overlayPixelSizeInMapUnits(F),ue=E.basemapSpatialReference;z=(0,p.pC)(ue)&&!ue.equals(E.spatialReference)?(0,Z.c9)(ue)/(0,Z.c9)(E.spatialReference):g*A}const $=F.x-z,T=F.y-z,X=F.x+z,R=F.y+z,{spatialReference:y}=E;return M.xmin=Math.min($,X),M.ymin=Math.min(T,R),M.xmax=Math.max($,X),M.ymax=Math.max(T,R),M.spatialReference=y,M}new f.Z},79530:(G,V,l)=>{function d(m){var v;const h=m.layer;return"floorInfo"in h&&null!=(v=h.floorInfo)&&v.floorField&&"floors"in m.view?f(m.view.floors,h.floorInfo.floorField):null}function p(m,v){var h;return"floorInfo"in v&&null!=(h=v.floorInfo)&&h.floorField?f(m,v.floorInfo.floorField):null}function Z(m,v){const{definitionExpression:h}=v;return m?h?`(${h}) AND (${m})`:m:h}function f(m,v){if(null==m||!m.length)return null;const h=m.filter(F=>""!==F).map(F=>`'${F}'`);return h.push("''"),`${v} IN (${h.join(",")}) OR ${v} IS NULL`}l.d(V,{Hp:()=>Z,cx:()=>d,ff:()=>p})}}]);