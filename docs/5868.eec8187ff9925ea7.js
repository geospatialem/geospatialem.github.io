"use strict";var it=Object.defineProperty,q=Object.getOwnPropertySymbols,rt=Object.prototype.hasOwnProperty,at=Object.prototype.propertyIsEnumerable,tt=(D,p,t)=>p in D?it(D,p,{enumerable:!0,configurable:!0,writable:!0,value:t}):D[p]=t,Z=(D,p)=>{for(var t in p||(p={}))rt.call(p,t)&&tt(D,t,p[t]);if(q)for(var t of q(p))at.call(p,t)&&tt(D,t,p[t]);return D};(self.webpackChunksite=self.webpackChunksite||[]).push([[5868],{90301:(D,p,t)=>{t.d(p,{eY:()=>W});var r=t(62208),c=t(30217),x=t(49966),_=t(9545),l=t(57477),v=t(14403),P=t(55086);function T(m,i,o){const n={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};return i&&o&&(n.width=i,n.height=o),new P.Z(m,n)}class W extends l.s{constructor(i=null,o,n=!0){super(),this.requestRenderOnSourceChangedEnabled=n,this._textureInvalidated=!0,this.stencilRef=0,this.coordScale=[1,1],this._height=void 0,this.pixelRatio=1,this.resolution=0,this.rotation=0,this._source=null,this._width=void 0,this.x=0,this.y=0,this.blendFunction=o,this.source=i,this.requestRender=this.requestRender.bind(this)}destroy(){this._texture&&(this._texture.dispose(),this._texture=null)}get isSourceScaled(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight}get height(){return void 0!==this._height?this._height:this.sourceHeight}set height(i){this._height=i}get source(){return this._source}set source(i){this._source=i,this.invalidateTexture()}get sourceHeight(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height}get sourceWidth(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width}get width(){return void 0!==this._width?this._width:this.sourceWidth}set width(i){this._width=i}beforeRender(i){super.beforeRender(i),this.updateTexture(i.context)}invalidateTexture(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())}_createTransforms(){return{dvs:(0,x.c)()}}setTransform(i){const o=(0,c.b)(this.transforms.dvs),[n,y]=i.toScreenNoRotation([0,0],[this.x,this.y]),O=this.resolution/this.pixelRatio/i.resolution,L=O*this.width,I=O*this.height,A=Math.PI*this.rotation/180;(0,c.c)(o,o,(0,_.f)(n,y)),(0,c.c)(o,o,(0,_.f)(L/2,I/2)),(0,c.r)(o,o,-A),(0,c.c)(o,o,(0,_.f)(-L/2,-I/2)),(0,c.j)(o,o,(0,_.f)(L,I)),(0,c.m)(this.transforms.dvs,i.displayViewMat3,o)}setSamplingProfile(i){this._texture&&(i.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(i.samplingMode))}bind(i,o){this._texture&&i.bindTexture(this._texture,o)}updateTexture(i){var o;if(!this.stage)return null==(o=this._texture)||o.dispose(),void(this._texture=null);if(!this._textureInvalidated)return;this._textureInvalidated=!1,this._texture||(this._texture=this.source?T(i,this.sourceWidth,this.sourceHeight):T(i));const n=this.source;if(n){if(this._texture.resize(this.sourceWidth,this.sourceHeight),function f(m){return m&&"render"in m}(n))if(n instanceof v.Z){const y=n.getRenderedRasterPixels();this._texture.setData((0,r.pC)(y)?y.renderedRasterPixels:null)}else this._texture.setData(function S(m){const i=document.createElement("canvas");return i.width=m.width,i.height=m.height,m.render(i.getContext("2d")),i}(n));else(function u(m){return m&&!("render"in m)})(n)&&this._texture.setData(n);this.ready()}else this._texture.setData(null)}onAttach(){this.invalidateTexture()}onDetach(){this.invalidateTexture()}}},91757:(D,p,t)=>{t.d(p,{c:()=>_});var r=t(2361),c=t(39406),x=t(44589);class _ extends x.Z{get requiresDedicatedFBO(){return this.children.some(v=>"additive"===v.blendFunction)}prepareRenderPasses(v){const P=v.registerRenderPass({name:"bitmap",brushes:[r.U.bitmap],target:()=>this.children,drawPhase:c.jx.MAP});return[...super.prepareRenderPasses(v),P]}}},14403:(D,p,t)=>{t.d(p,{Z:()=>c});var r=t(62208);class c{constructor(_,l,v){this.pixelBlock=_,this.extent=l,this.originalPixelBlock=v}get width(){return(0,r.pC)(this.pixelBlock)?this.pixelBlock.width:0}get height(){return(0,r.pC)(this.pixelBlock)?this.pixelBlock.height:0}render(_){const l=this.pixelBlock;if((0,r.Wi)(l))return;const v=this.filter({pixelBlock:l});if((0,r.Wi)(v.pixelBlock))return;const P=v.pixelBlock.getAsRGBA(),f=_.createImageData(v.pixelBlock.width,v.pixelBlock.height);f.data.set(P),_.putImageData(f,0,0)}getRenderedRasterPixels(){const _=this.filter({pixelBlock:this.pixelBlock});return(0,r.Wi)(_.pixelBlock)?null:{width:_.pixelBlock.width,height:_.pixelBlock.height,renderedRasterPixels:new Uint8Array(_.pixelBlock.getAsRGBA().buffer)}}}},85868:(D,p,t)=>{t.r(p),t.d(p,{default:()=>G});var r=t(15861),c=t(17626),x=t(24263),_=t(84792),l=t(7093),v=t(72392),P=t(62208),f=t(21726),u=t(77712),m=(t(85931),t(8314),t(90912),t(76898)),i=t(2004),o=t(56741),n=t(65234),y=t(46367),O=t(98686),L=t(2618),I=t(51815),A=t(90301),H=t(91757),F=t(37384),b=t(36275),j=t(97291),w=t(45611);class K{constructor(){this.allSublayers=new Map,this.allPoints=[],this.allPolylines=[],this.allPolygons=[],this.allMapImages=[]}}let M=class extends((0,F.y)(w.Z)){constructor(){super(...arguments),this._handles=new v.Z,this._bitmapIndex=new Map,this._mapImageContainer=new H.c,this._kmlVisualData=new K,this.allVisiblePoints=new I.J,this.allVisiblePolylines=new I.J,this.allVisiblePolygons=new I.J,this.allVisibleMapImages=new l.Z}hitTest(e,a){var d=this;return(0,r.Z)(function*(){var h,g,s;return(yield Promise.all([null==(h=d._pointsView)?void 0:h.hitTest(e),null==(g=d._polylinesView)?void 0:g.hitTest(e),null==(s=d._polygonsView)?void 0:s.hitTest(e)])).flat().filter(C=>!!C&&(C.layer=d.layer,C.sourceLayer=d.layer,!0))})()}update(e){this._polygonsView&&this._polygonsView.processUpdate(e),this._polylinesView&&this._polylinesView.processUpdate(e),this._pointsView&&this._pointsView.processUpdate(e)}attach(){this._handles.add([this.allVisibleMapImages.on("change",e=>{e.added.forEach(a=>this._addMapImage(a)),e.removed.forEach(a=>this._removeMapImage(a))})]),this.container.addChild(this._mapImageContainer),this._polygonsView=new j.Z({view:this.view,graphics:this.allVisiblePolygons,requestUpdateCallback:()=>this.requestUpdate(),container:new b.Z(this.view.featuresTilingScheme)}),this.container.addChild(this._polygonsView.container),this._polylinesView=new j.Z({view:this.view,graphics:this.allVisiblePolylines,requestUpdateCallback:()=>this.requestUpdate(),container:new b.Z(this.view.featuresTilingScheme)}),this.container.addChild(this._polylinesView.container),this._pointsView=new j.Z({view:this.view,graphics:this.allVisiblePoints,requestUpdateCallback:()=>this.requestUpdate(),container:new b.Z(this.view.featuresTilingScheme)}),this.container.addChild(this._pointsView.container),this.watch("layer.visibleSublayers",e=>{for(const[a,d]of this._kmlVisualData.allSublayers)d.visibility=0;for(const a of e){const d=this._kmlVisualData.allSublayers.get(a.id);d&&(d.visibility=1)}this._refreshCollections()}),this._fetchingPromise=this._fetchService().then(()=>{this._fetchingPromise=null,this.notifyChange("updating")})}detach(){this._handles.removeAll(),this._mapImageContainer.removeAllChildren(),this.container.removeAllChildren(),this._bitmapIndex.clear(),this._polygonsView&&(this._polygonsView.destroy(),this._polygonsView=null),this._polylinesView&&(this._polylinesView.destroy(),this._polylinesView=null),this._pointsView&&(this._pointsView.destroy(),this._pointsView=null)}moveStart(){}viewChange(){this._polygonsView.viewChange(),this._polylinesView.viewChange(),this._pointsView.viewChange()}moveEnd(){}isUpdating(){return null!=this._fetchingPromise||this._pointsView.updating||this._polygonsView.updating||this._polylinesView.updating}_addMapImage(e){(this.view.spatialReference.isWGS84||this.view.spatialReference.isWebMercator)&&(0,_.default)(e.href,{responseType:"image"}).then(({data:a})=>{let d=i.Z.fromJSON(e.extent);(0,y.Q8)(d,this.view.spatialReference)&&(d=(0,y.iV)(d,this.view.spatialReference));const h=new A.eY(a,"standard");h.x=d.xmin,h.y=d.ymax,h.resolution=d.width/a.naturalWidth,h.rotation=e.rotation,this._mapImageContainer.addChild(h),this._bitmapIndex.set(e,h)})}_getViewDependentUrl(e,a){return(0,r.Z)(function*(){const{viewFormat:d,viewBoundScale:h,httpQuery:g}=e;if((0,P.pC)(d)){if((0,P.Wi)(a))throw new Error("Loading this network link requires a view state.");let s;if(yield(0,o.zD)(),(0,P.pC)(h)&&1!==h){const B=new i.Z(a.extent);B.expand(h),s=B}else s=a.extent;s=(0,o.iV)(s,n.Z.WGS84);const C=(0,o.iV)(s,n.Z.WebMercator),R=s.xmin,V=s.xmax,U=s.ymin,E=s.ymax,et=a.size[0]*a.pixelRatio,st=a.size[1]*a.pixelRatio,Y=Math.max(C.width,C.height),$={"[bboxWest]":R.toString(),"[bboxEast]":V.toString(),"[bboxSouth]":U.toString(),"[bboxNorth]":E.toString(),"[lookatLon]":s.center.x.toString(),"[lookatLat]":s.center.y.toString(),"[lookatRange]":Y.toString(),"[lookatTilt]":"0","[lookatHeading]":a.rotation.toString(),"[lookatTerrainLon]":s.center.x.toString(),"[lookatTerrainLat]":s.center.y.toString(),"[lookatTerrainAlt]":"0","[cameraLon]":s.center.x.toString(),"[cameraLat]":s.center.y.toString(),"[cameraAlt]":Y.toString(),"[horizFov]":"60","[vertFov]":"60","[horizPixels]":et.toString(),"[vertPixels]":st.toString(),"[terrainEnabled]":"0","[clientVersion]":x.i8,"[kmlVersion]":"2.2","[clientName]":"ArcGIS API for JavaScript","[language]":"en-US"},Q=B=>{for(const k in B)for(const X in $)B[k]=B[k].replace(X,$[X])},N=(0,f.u0)(d);Q(N);let z={};(0,P.pC)(g)&&(z=(0,f.u0)(g),Q(z));const J=(0,L.en)(e.href);return J.query=Z(Z(Z({},J.query),N),z),`${J.path}?${(0,f.B7)(N)}`}return e.href})()}_fetchService(){var e=this;return(0,r.Z)(function*(){const a=new K;yield e._loadVisualData(e.layer.url,a),e._kmlVisualData=a,e._refreshCollections()})()}_refreshCollections(){this.allVisiblePoints.removeAll(),this.allVisiblePolylines.removeAll(),this.allVisiblePolygons.removeAll(),this.allVisibleMapImages.removeAll(),this.allVisiblePoints.addMany(this._kmlVisualData.allPoints.filter(e=>this._isSublayerVisible(e.sublayerId)).map(({item:e})=>e)),this.allVisiblePolylines.addMany(this._kmlVisualData.allPolylines.filter(e=>this._isSublayerVisible(e.sublayerId)).map(({item:e})=>e)),this.allVisiblePolygons.addMany(this._kmlVisualData.allPolygons.filter(e=>this._isSublayerVisible(e.sublayerId)).map(({item:e})=>e)),this.allVisibleMapImages.addMany(this._kmlVisualData.allMapImages.filter(e=>this._isSublayerVisible(e.sublayerId)).map(({item:e})=>e))}_isSublayerVisible(e){const a=this._kmlVisualData.allSublayers.get(e);return!!a.visibility&&(-1===a.parentFolderId||this._isSublayerVisible(a.parentFolderId))}_loadVisualData(e,a){var d=this;return this._fetchParsedKML(e).then(function(){var h=(0,r.Z)(function*(g){for(const s of g.sublayers){a.allSublayers.set(s.id,s);const C=s.points?yield(0,O.Yu)(s.points):[],R=s.polylines?yield(0,O.Yu)(s.polylines):[],V=s.polygons?yield(0,O.Yu)(s.polygons):[],U=s.mapImages||[];if(a.allPoints.push(...C.map(E=>({item:E,sublayerId:s.id}))),a.allPolylines.push(...R.map(E=>({item:E,sublayerId:s.id}))),a.allPolygons.push(...V.map(E=>({item:E,sublayerId:s.id}))),a.allMapImages.push(...U.map(E=>({item:E,sublayerId:s.id}))),s.networkLink){const E=yield d._getViewDependentUrl(s.networkLink,d.view.state);yield d._loadVisualData(E,a)}}});return function(g){return h.apply(this,arguments)}}())}_fetchParsedKML(e){return(0,O.CS)(e,this.view.spatialReference,this.layer.refreshInterval).then(a=>(0,O.Cw)(a.data))}_removeMapImage(e){const a=this._bitmapIndex.get(e);a&&(this._mapImageContainer.removeChild(a),this._bitmapIndex.delete(e))}};(0,c._)([(0,u.Cb)()],M.prototype,"_pointsView",void 0),(0,c._)([(0,u.Cb)()],M.prototype,"_polylinesView",void 0),(0,c._)([(0,u.Cb)()],M.prototype,"_polygonsView",void 0),(0,c._)([(0,u.Cb)()],M.prototype,"_fetchingPromise",void 0),(0,c._)([(0,u.Cb)()],M.prototype,"updating",void 0),M=(0,c._)([(0,m.j)("esri.views.2d.layers.KMLLayerView2D")],M);const G=M},37384:(D,p,t)=>{t.d(p,{y:()=>a});var r=t(17626),c=t(7093),x=t(89726),_=t(27e3),l=t(77712),u=(t(85931),t(8314),t(90912),t(76898)),S=t(1011),T=t(86162);t(63290),t(82255);let i=class extends T.wq{};i=(0,r._)([(0,u.j)("esri.views.layers.support.ClipArea")],i);const o=i;var n;let y=n=class extends o{constructor(){super(...arguments),this.type="rect",this.left=null,this.right=null,this.top=null,this.bottom=null}clone(){return new n({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}get version(){return(this._get("version")||0)+1}};(0,r._)([(0,l.Cb)({type:[Number,String],json:{write:!0}})],y.prototype,"left",void 0),(0,r._)([(0,l.Cb)({type:[Number,String],json:{write:!0}})],y.prototype,"right",void 0),(0,r._)([(0,l.Cb)({type:[Number,String],json:{write:!0}})],y.prototype,"top",void 0),(0,r._)([(0,l.Cb)({type:[Number,String],json:{write:!0}})],y.prototype,"bottom",void 0),(0,r._)([(0,l.Cb)({readOnly:!0})],y.prototype,"version",null),y=n=(0,r._)([(0,u.j)("esri.views.layers.support.ClipRect")],y);const O=y;t(29132);var b,I=t(21674),A=t(91179),H=t(2004),F=t(37118);const j={base:I.Z,key:"type",typeMap:{extent:H.Z,polygon:F.Z}};let w=b=class extends o{constructor(){super(...arguments),this.type="geometry",this.geometry=null}get version(){return(this._get("version")||0)+1}clone(){return new b({geometry:this.geometry.clone()})}};(0,r._)([(0,l.Cb)({types:j,json:{read:A.im,write:!0}})],w.prototype,"geometry",void 0),(0,r._)([(0,l.Cb)({readOnly:!0})],w.prototype,"version",null),w=b=(0,r._)([(0,u.j)("esri.views.layers.support.Geometry")],w);const K=w;let M=class extends o{constructor(){super(...arguments),this.type="path",this.path=[]}get version(){return(this._get("version")||0)+1}};(0,r._)([(0,l.Cb)({type:[[[Number]]],json:{write:!0}})],M.prototype,"path",void 0),(0,r._)([(0,l.Cb)({readOnly:!0})],M.prototype,"version",null),M=(0,r._)([(0,u.j)("esri.views.layers.support.Path")],M);const e=c.Z.ofType({key:"type",base:o,typeMap:{rect:O,path:M,geometry:K}}),a=d=>{let h=class extends d{constructor(){super(...arguments),this.clips=new e,this.moving=!1,this.attached=!1,this.lastUpdateId=-1,this.updateRequested=!1}initialize(){var g;this.container||(this.container=new S.W),this.container.fadeTransitionEnabled=!0,this.container.opacity=0,this.container.clips=this.clips,this.handles.add([(0,_.S1)(this,"suspended",s=>{this.container&&(this.container.visible=!s),this.view&&!s&&this.updateRequested&&this.view.requestUpdate()},!0),(0,_.S1)(this,["layer.opacity","container"],()=>{var s,C;this.container&&(this.container.opacity=null!=(s=null==(C=this.layer)?void 0:C.opacity)?s:1)},!0),(0,_.S1)(this,["layer.blendMode"],s=>{this.container&&(this.container.blendMode=s)},!0),(0,_.S1)(this,["layer.effect"],s=>{this.container&&(this.container.effect=s)},!0),this.clips.on("change",()=>{this.container.clips=this.clips,this.notifyChange("clips")})]),null!=(g=this.view)&&g.whenLayerView?this.view.whenLayerView(this.layer).then(s=>{s!==this||this.attached||this.destroyed||(this.attach(),this.requestUpdate(),this.attached=!0)},()=>{}):this.when().then(()=>{this.attached||this.destroyed||(this.attach(),this.requestUpdate(),this.attached=!0)},()=>{})}destroy(){this.attached&&(this.detach(),this.attached=!1),this.handles.remove("initialize"),this.updateRequested=!1}get updating(){return!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!(!this.updatingHandles||!this.updatingHandles.updating)}isVisibleAtScale(g){let s=!0;const C=this.layer,R=C.minScale,V=C.maxScale;if(null!=R&&null!=V){let U=!R,E=!V;!U&&g<=R&&(U=!0),!E&&g>=V&&(E=!0),s=U&&E}return s}requestUpdate(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())}processUpdate(g){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",g),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(g))):this.updateRequested=!1}hitTest(g,s){return Promise.resolve(null)}isUpdating(){return!1}isRendering(){return!1}canResume(){return!!super.canResume()&&this.isVisibleAtScale(this.view.scale)}};return(0,r._)([(0,l.Cb)({type:e,set(g){const s=(0,x.Z)(g,this._get("clips"),e);this._set("clips",s)}})],h.prototype,"clips",void 0),(0,r._)([(0,l.Cb)()],h.prototype,"moving",void 0),(0,r._)([(0,l.Cb)()],h.prototype,"attached",void 0),(0,r._)([(0,l.Cb)()],h.prototype,"container",void 0),(0,r._)([(0,l.Cb)()],h.prototype,"suspended",void 0),(0,r._)([(0,l.Cb)({readOnly:!0})],h.prototype,"updateParameters",void 0),(0,r._)([(0,l.Cb)()],h.prototype,"updateRequested",void 0),(0,r._)([(0,l.Cb)()],h.prototype,"updating",null),(0,r._)([(0,l.Cb)()],h.prototype,"view",void 0),h=(0,r._)([(0,u.j)("esri.views.2d.layers.LayerView2D")],h),h}},45611:(D,p,t)=>{t.d(p,{Z:()=>o});var r=t(17626),c=t(14517),x=t(61885),_=t(80542),l=t(61996),v=t(63290),P=t(62208),f=t(60330),u=t(77712),m=(t(85931),t(8314),t(90912),t(76898));let i=class extends((0,_.p)((0,l.I)((0,f.v)(x.Z.EventedMixin(c.Z))))){constructor(n){super(n),this.layer=null,this.parent=null}initialize(){this.when().catch(n=>{if("layerview:create-error"!==n.name){const y=this.layer&&this.layer.id||"no id",O=this.layer&&this.layer.title||"no title";throw v.Z.getLogger(this.declaredClass).error("#resolve()",`Failed to resolve layer view (layer title: '${O}', id: '${y}')`,n),n}})}get fullOpacity(){return(0,P.Pt)(this.get("layer.opacity"),1)*(0,P.Pt)(this.get("parent.fullOpacity"),1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer.legendEnabled}get updating(){return!!(this.updatingHandles&&this.updatingHandles.updating||this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){var n;return!0===(null==(n=this.layer)?void 0:n.visible)}set visible(n){void 0!==n?this._override("visible",n):this._clearOverride("visible")}canResume(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.get("layer.loaded")&&this.visible||!1}getSuspendInfo(){const n=this.parent&&this.parent.suspended?this.parent.suspendInfo:{};return this.view&&this.view.ready||(n.viewNotReady=!0),this.layer&&this.layer.loaded||(n.layerNotLoaded=!0),this.visible||(n.layerInvisible=!0),n}isUpdating(){return!1}};(0,r._)([(0,u.Cb)()],i.prototype,"fullOpacity",null),(0,r._)([(0,u.Cb)()],i.prototype,"layer",void 0),(0,r._)([(0,u.Cb)()],i.prototype,"parent",void 0),(0,r._)([(0,u.Cb)({readOnly:!0})],i.prototype,"suspended",null),(0,r._)([(0,u.Cb)({readOnly:!0})],i.prototype,"suspendInfo",null),(0,r._)([(0,u.Cb)({readOnly:!0})],i.prototype,"legendEnabled",null),(0,r._)([(0,u.Cb)({type:Boolean,readOnly:!0})],i.prototype,"updating",null),(0,r._)([(0,u.Cb)({readOnly:!0})],i.prototype,"updatingProgress",null),(0,r._)([(0,u.Cb)()],i.prototype,"visible",null),i=(0,r._)([(0,m.j)("esri.views.layers.LayerView")],i);const o=i}}]);