"use strict";var C=Object.defineProperty,g=Object.defineProperties,L=Object.getOwnPropertyDescriptors,p=Object.getOwnPropertySymbols,T=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable,E=(n,s,e)=>s in n?C(n,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[s]=e,O=(n,s)=>{for(var e in s||(s={}))T.call(s,e)&&E(n,e,s[e]);if(p)for(var e of p(s))U.call(s,e)&&E(n,e,s[e]);return n},h=(n,s)=>g(n,L(s));(self.webpackChunksite=self.webpackChunksite||[]).push([[9051],{39051:(n,s,e)=>{e.r(s),e.d(s,{default:()=>R});var v=e(15861),_=e(17626),u=e(26584),l=e(62208),d=e(77712),m=(e(85931),e(8314),e(90912),e(76898)),D=e(17253),f=e(68915),P=e(43930);function y(t,r){if((0,l.Wi)(t)&&(0,l.Wi)(r))return null;const a={};return(0,l.pC)(r)&&(a.geometry=r.toJSON()),(0,l.pC)(t)&&(a.where=t),a}let i=class extends f.default{constructor(){super(...arguments),this._enabledDataReceived=!1,this.errorString=null,this.connectionStatus="disconnected"}initialize(){this.handles.add([this.layer.watch("purgeOptions",()=>this._update())])}destroy(){this.connectionStatus="disconnected"}get connectionError(){if(this.errorString)return new u.Z("stream-controller",this.errorString)}on(t,r){"data-received"===t&&(this._enabledDataReceived=!0,this._proxy.enableEvent("data-received",!0));const a=super.on(t,r),o=this;return{remove(){a.remove(),"data-received"===t&&(o._proxy.closed||o.hasEventListener("data-received")||o._proxy.enableEvent("data-received",!1))}}}queryLatestObservations(t,r){if(!this.layer.timeInfo.endField&&!this.layer.timeInfo.startField)throw new u.Z("streamlayer-no-timeField","queryLatestObservation can only be used with services that define a TrackIdField");return this._proxy.queryLatestObservations(this._cleanUpQuery(t),r).then(a=>{const o=D.default.fromJSON(a);return o.features.forEach(c=>{c.layer=this.layer,c.sourceLayer=this.layer}),o})}_createClientOptions(){return h(O({},super._createClientOptions()),{setProperty:t=>{this.set(t.propertyName,t.value)}})}_createTileRendererHash(t){const r=`${JSON.stringify(this.layer.purgeOptions)}.${JSON.stringify(y(this.layer.definitionExpression,this.layer.geometryDefinition))})`;return super._createTileRendererHash(t)+r}_createServiceOptions(){var t=this;return(0,v.Z)(function*(){const r=t.layer,{objectIdField:a}=r,o=r.fields.map(S=>S.toJSON()),c=(0,P.oq)(r.geometryType),I=r.timeInfo&&r.timeInfo.toJSON()||null,M=r.spatialReference?r.spatialReference.toJSON():null;return{type:"stream",fields:o,geometryType:c,objectIdField:a,timeInfo:I,source:t.layer.parsedUrl,serviceFilter:y(t.layer.definitionExpression,t.layer.geometryDefinition),purgeOptions:t.layer.purgeOptions.toJSON(),enableDataReceived:t._enabledDataReceived,spatialReference:M,maxReconnectionAttempts:t.layer.maxReconnectionAttempts,maxReconnectionInterval:t.layer.maxReconnectionInterval,updateInterval:t.layer.updateInterval,customParameters:r.customParameters}})()}};(0,_._)([(0,d.Cb)()],i.prototype,"errorString",void 0),(0,_._)([(0,d.Cb)({readOnly:!0})],i.prototype,"connectionError",null),(0,_._)([(0,d.Cb)()],i.prototype,"connectionStatus",void 0),i=(0,_._)([(0,m.j)("esri.views.2d.layers.StreamLayerView2D")],i);const R=i}}]);