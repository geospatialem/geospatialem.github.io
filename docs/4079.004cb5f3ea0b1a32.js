"use strict";var re=Object.defineProperty,se=Object.defineProperties,ie=Object.getOwnPropertyDescriptors,ee=Object.getOwnPropertySymbols,oe=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable,te=(O,m,u)=>m in O?re(O,m,{enumerable:!0,configurable:!0,writable:!0,value:u}):O[m]=u,Q=(O,m)=>{for(var u in m||(m={}))oe.call(m,u)&&te(O,u,m[u]);if(ee)for(var u of ee(m))ae.call(m,u)&&te(O,u,m[u]);return O},ne=(O,m)=>se(O,ie(m));(self.webpackChunksite=self.webpackChunksite||[]).push([[4079],{84079:(O,m,u)=>{u.r(m),u.d(m,{default:()=>V});var g=u(15861),G=u(84792),R=u(26584),Z=u(63290),U=u(62208),v=u(10699),x=u(91179),b=u(37053),y=u(82054),I=u(82708),P=u(82959),K=u(38330),T=u(58775),B=u(56554),h=u(35775),k=u(60466),J=u(85),$=u(36630);const z={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsPercentileStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}};class V{constructor(){var s=this;this._queryEngine=null,this._snapshotFeatures=function(){var i=(0,g.Z)(function*(r){const a=yield s._fetch(r);return s._createFeatures(a)});return function(r){return i.apply(this,arguments)}}()}destroy(){var s;null==(s=this._queryEngine)||s.destroy(),this._queryEngine=this._fieldsIndex=this._createDefaultAttributes=null}load(s,i={}){var r=this;return(0,g.Z)(function*(){r.loadOptions={url:s.url,customParameters:s.customParameters};const a=[];yield r._checkProjection(s.spatialReference);let d=null;s.url&&(d=yield r._fetch(null==i?void 0:i.signal));const c=(0,T.my)(d,{geometryType:s.geometryType}),_=s.fields||c.fields||[],E=null!=s.hasZ?s.hasZ:c.hasZ,j=c.geometryType,e=s.objectIdField||c.objectIdFieldName||"__OBJECTID",t=s.spatialReference||b.Zn;let n=s.timeInfo;_===c.fields&&c.unknownFields.length>0&&a.push({name:"geojson-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:c.unknownFields}});let o=_.find(l=>l.name===e);o?("esriFieldTypeString"!==o.type&&(o.type="esriFieldTypeOID"),o.editable=!1,o.nullable=!1):(o={alias:e,name:e,type:"string"===c.objectIdFieldType?"esriFieldTypeString":"esriFieldTypeOID",editable:!1,nullable:!1},_.unshift(o));const p={};for(const l of _){if(null==l.name&&(l.name=l.alias),null==l.alias&&(l.alias=l.name),!l.name)throw new R.Z("geojson-layer:invalid-field-name","field name is missing",{field:l});if(!J.v.jsonValues.includes(l.type))throw new R.Z("geojson-layer:invalid-field-type",`invalid type for field "${l.name}"`,{field:l});if(l.name!==o.name){const C=(0,$.os)(l);void 0!==C&&(p[l.name]=C)}}r._fieldsIndex=new k.Z(_);const S=r._fieldsIndex.requiredFields.indexOf(o);if(S>-1&&r._fieldsIndex.requiredFields.splice(S,1),n){if(n.startTimeField){const l=r._fieldsIndex.get(n.startTimeField);l?(n.startTimeField=l.name,l.type="esriFieldTypeDate"):n.startTimeField=null}if(n.endTimeField){const l=r._fieldsIndex.get(n.endTimeField);l?(n.endTimeField=l.name,l.type="esriFieldTypeDate"):n.endTimeField=null}if(n.trackIdField){const l=r._fieldsIndex.get(n.trackIdField);l?n.trackIdField=l.name:(n.trackIdField=null,a.push({name:"geojson-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:n}}))}n.startTimeField||n.endTimeField||(a.push({name:"geojson-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:n}}),n=null)}const F=j?(0,B.bU)(j):null,f={warnings:a,featureErrors:[],layerDefinition:ne(Q({},z),{drawingInfo:F,templates:(0,B.Hq)(p),extent:null,geometryType:j,objectIdField:e,fields:_,hasZ:!!E,timeInfo:n})};r._queryEngine=new K.Z({fields:_,geometryType:j,hasM:!1,hasZ:E,objectIdField:e,spatialReference:t,timeInfo:n,featureStore:new I.Z({geometryType:j,hasM:!1,hasZ:E}),cacheSpatialQueries:!0}),r._createDefaultAttributes=(0,B.Dm)(p,e);const M=yield r._createFeatures(d);r._objectIdGenerator=r._createObjectIdGenerator(r._queryEngine,M);const D=r._normalizeFeatures(M,f.warnings,f.featureErrors);if(r._queryEngine.featureStore.addMany(D),f.layerDefinition.extent=r._queryEngine.fullExtent,f.layerDefinition.timeInfo){const{start:l,end:C}=r._queryEngine.timeExtent;f.layerDefinition.timeInfo.timeExtent=[l,C]}return f})()}applyEdits(s){var i=this;return(0,g.Z)(function*(){const{spatialReference:r,geometryType:a}=i._queryEngine;return yield Promise.all([(0,h.b)(r,a),(0,P._W)(s.adds,r),(0,P._W)(s.updates,r)]),yield i._waitSnapshotComplete(),i._applyEdits(s)})()}queryFeatures(s={},i={}){var r=this;return(0,g.Z)(function*(){return yield r._waitSnapshotComplete(),r._queryEngine.executeQuery(s,i.signal)})()}queryFeatureCount(s={},i={}){var r=this;return(0,g.Z)(function*(){return yield r._waitSnapshotComplete(),r._queryEngine.executeQueryForCount(s,i.signal)})()}queryObjectIds(s={},i={}){var r=this;return(0,g.Z)(function*(){return yield r._waitSnapshotComplete(),r._queryEngine.executeQueryForIds(s,i.signal)})()}queryExtent(s={},i={}){var r=this;return(0,g.Z)(function*(){return yield r._waitSnapshotComplete(),r._queryEngine.executeQueryForExtent(s,i.signal)})()}querySnapping(s,i={}){var r=this;return(0,g.Z)(function*(){return yield r._waitSnapshotComplete(),r._queryEngine.executeQueryForSnapping(s,i.signal)})()}refresh(s){var i=this;return(0,g.Z)(function*(){var r;return i.loadOptions.customParameters=s,null==(r=i._snapshotTask)||r.abort(),i._snapshotTask=(0,v.vr)(i._snapshotFeatures),i._snapshotTask.promise.then(a=>{i._queryEngine.featureStore.clear(),i._objectIdGenerator=i._createObjectIdGenerator(i._queryEngine,a);const d=i._normalizeFeatures(a);d&&i._queryEngine.featureStore.addMany(d)},a=>{i._queryEngine.featureStore.clear(),(0,v.D_)(a)||Z.Z.getLogger("esri.layers.GeoJSONLayer").error(new R.Z("geojson-layer:refresh","An error occurred during refresh",{error:a}))}),yield i._waitSnapshotComplete(),{extent:i._queryEngine.fullExtent,timeExtent:i._queryEngine.timeExtent}})()}_createFeatures(s){var i=this;return(0,g.Z)(function*(){const{geometryType:r,hasZ:a,objectIdField:d}=i._queryEngine,c=(0,T.lG)(s,{geometryType:r,hasZ:a,objectIdField:d});if(!(0,b.fS)(i._queryEngine.spatialReference,b.Zn))for(const _ of c)(0,U.pC)(_.geometry)&&(_.geometry=(0,y.GH)((0,P.iV)((0,y.di)(_.geometry,i._queryEngine.geometryType,i._queryEngine.hasZ,!1),b.Zn,i._queryEngine.spatialReference)));return c})()}_waitSnapshotComplete(){var s=this;return(0,g.Z)(function*(){if(s._snapshotTask&&!s._snapshotTask.finished){try{yield s._snapshotTask.promise}catch(i){}return s._waitSnapshotComplete()}})()}_fetch(s){var i=this;return(0,g.Z)(function*(){const{url:r,customParameters:a}=i.loadOptions,d=(yield(0,G.default)(r,{responseType:"json",query:Q({},a),signal:s})).data;return yield(0,T.O3)(d),d})()}_normalizeFeatures(s,i,r){const{objectIdField:a}=this._queryEngine,d=[];for(const c of s){const _=this._createDefaultAttributes(),E=(0,h.O0)(this._fieldsIndex,_,c.attributes,!0,i);E?null==r||r.push(E):(this._assignObjectId(_,c.attributes,!0),c.attributes=_,c.objectId=_[a],d.push(c))}return d}_applyEdits(s){const{adds:i,updates:r,deletes:a}=s,d={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};if(i&&i.length&&this._applyAddEdits(d,i),r&&r.length&&this._applyUpdateEdits(d,r),a&&a.length){for(const c of a)d.deleteResults.push((0,h.d1)(c));this._queryEngine.featureStore.removeManyById(a)}return{extent:this._queryEngine.fullExtent,timeExtent:this._queryEngine.timeExtent,featureEditResults:d}}_applyAddEdits(s,i){const{addResults:r}=s,{geometryType:a,hasM:d,hasZ:c,objectIdField:_,spatialReference:E,featureStore:j}=this._queryEngine,e=[];for(const t of i){if(t.geometry&&a!==(0,x.Ji)(t.geometry)){r.push((0,h.av)("Incorrect geometry type."));continue}const n=this._createDefaultAttributes(),o=(0,h.O0)(this._fieldsIndex,n,t.attributes);o?r.push(o):(this._assignObjectId(n,t.attributes),t.attributes=n,null!=t.uid&&(s.uidToObjectId[t.uid]=t.attributes[_]),(0,U.pC)(t.geometry)&&(t.geometry=(0,P.iV)((0,h.og)(t.geometry,E),t.geometry.spatialReference,E)),e.push(t),r.push((0,h.d1)(t.attributes[_])))}j.addMany((0,y.Yn)([],e,a,c,d,_))}_applyUpdateEdits({updateResults:s},i){const{geometryType:r,hasM:a,hasZ:d,objectIdField:c,spatialReference:_,featureStore:E}=this._queryEngine;for(const j of i){const{attributes:e,geometry:t}=j,n=e&&e[c];if(null==n){s.push((0,h.av)(`Identifier field ${c} missing`));continue}if(!E.has(n)){s.push((0,h.av)(`Feature with object id ${n} missing`));continue}const o=(0,y.EI)(E.getFeature(n),r,d,a);if((0,U.pC)(t)){if(r!==(0,x.Ji)(t)){s.push((0,h.av)("Incorrect geometry type."));continue}o.geometry=(0,P.iV)((0,h.og)(t,_),t.spatialReference,_)}if(e){const p=(0,h.O0)(this._fieldsIndex,o.attributes,e);if(p){s.push(p);continue}}E.add((0,y.XA)(o,r,d,a,c)),s.push((0,h.d1)(n))}}_createObjectIdGenerator(s,i){const r=s.fieldsIndex.get(s.objectIdField);if("esriFieldTypeString"===r.type)return()=>r.name+"-"+Date.now().toString(16);let a=Number.NEGATIVE_INFINITY;for(const d of i)d.objectId&&(a=Math.max(a,d.objectId));return a=Math.max(0,a)+1,()=>a++}_assignObjectId(s,i,r=!1){const a=this._queryEngine.objectIdField;s[a]=r&&a in i?i[a]:this._objectIdGenerator()}_checkProjection(s){return(0,g.Z)(function*(){try{yield(0,P._W)(b.Zn,s)}catch(i){throw new R.Z("geojson-layer","Projection not supported")}})()}}},58775:(O,m,u)=>{u.d(m,{lG:()=>j,q9:()=>v,my:()=>E,O3:()=>_});var g=u(26584),G=u(66385),R=u(88071),Z=u(36630);const U={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};function v(e){return U[e]}function*x(e){switch(e.type){case"Feature":yield e;break;case"FeatureCollection":for(const t of e.features)t&&(yield t)}}function*b(e){if(!e)return null;switch(e.type){case"Point":yield e.coordinates;break;case"LineString":case"MultiPoint":yield*e.coordinates;break;case"MultiLineString":case"Polygon":for(const t of e.coordinates)yield*t;break;case"MultiPolygon":for(const t of e.coordinates)for(const n of t)yield*n}}function I(e){for(const t of e)if(t.length>2)return!0;return!1}function T(e){let t=0;for(let n=0;n<e.length;n++){const o=e[n],p=e[(n+1)%e.length];t+=o[0]*p[1]-p[0]*o[1]}return t<=0}function B(e){const t=e[0],n=e[e.length-1];return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]||e.push(t),e}function h(e,t,n){switch(t.type){case"LineString":return function k(e,t,n){return r(e,t.coordinates,n),e}(e,t,n);case"MultiLineString":return function J(e,t,n){for(const o of t.coordinates)r(e,o,n);return e}(e,t,n);case"MultiPoint":return function $(e,t,n){return r(e,t.coordinates,n),e}(e,t,n);case"MultiPolygon":return function z(e,t,n){for(const o of t.coordinates){s(e,o[0],n);for(let p=1;p<o.length;p++)i(e,o[p],n)}return e}(e,t,n);case"Point":return function V(e,t,n){return d(e,t.coordinates,n),e}(e,t,n);case"Polygon":return function H(e,t,n){const o=t.coordinates;s(e,o[0],n);for(let p=1;p<o.length;p++)i(e,o[p],n);return e}(e,t,n)}}function s(e,t,n){const o=B(t);!function P(e){return!T(e)}(o)?r(e,o,n):a(e,o,n)}function i(e,t,n){const o=B(t);!function K(e){return T(e)}(o)?r(e,o,n):a(e,o,n)}function r(e,t,n){for(const o of t)d(e,o,n);e.lengths.push(t.length)}function a(e,t,n){for(let o=t.length-1;o>=0;o--)d(e,t[o],n);e.lengths.push(t.length)}function d(e,t,n){const[o,p,S]=t;e.coords.push(o,p),n.hasZ&&e.coords.push(S||0)}function c(e){switch(typeof e){case"string":return"esriFieldTypeString";case"number":return"esriFieldTypeDouble";default:return"unknown"}}function _(e){if(!e)throw new g.Z("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==e.type&&"FeatureCollection"!==e.type)throw new g.Z("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:e});const{crs:t}=e;if(!t)return;const n="string"==typeof t?t:"name"===t.type?t.properties.name:"EPSG"===t.type?t.properties.code:null,o=new RegExp(".*(CRS84H?|4326)$","i");if(!n||!o.test(n))throw new g.Z("geojson-layer:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:t})}function E(e,t={}){const n=[],o=new Set,p=new Set;let S,F=!1,f=null,M=!1,{geometryType:D=null}=t,l=!1;for(const q of x(e)){const{geometry:N,properties:L,id:W}=q;if((!N||(D||(D=v(N.type)),v(N.type)===D))&&(F||(F=I(b(N))),M||(M=null!=W,M&&(S=typeof W,f=Object.keys(L).filter(w=>L[w]===W))),M&&null!=W&&(f.length>1?f=f.filter(w=>L[w]===W):1===f.length&&(f=L[f[0]]===W?f:[])),!l&&L)){let w=!0;for(const A in L){if(o.has(A))continue;const Y=L[A];if(null==Y){w=!1,p.add(A);continue}const X=c(Y);"unknown"!==X?(p.delete(A),o.add(A),n.push({name:A,alias:A,type:X})):p.add(A)}l=w}}const C=f&&1===f.length&&f[0]||null;if(C)for(const q of n)if(q.name===C&&(0,Z.H7)(q)){q.type="esriFieldTypeOID";break}return{fields:n,geometryType:D,hasZ:F,objectIdFieldName:C,objectIdFieldType:S,unknownFields:Array.from(p)}}function j(e,t){return Array.from(function*y(e,t={}){const{geometryType:n,objectIdField:o}=t;for(const S of e){var p;const{geometry:F,properties:f,id:M}=S;if(F&&v(F.type)!==n)continue;const D=f||{};let l=null!=(p=D[o])?p:null;o&&null!=M&&!D[o]&&(D[o]=l=M),yield new G.ZP(F?h(new R.Z,F,t):null,D,null,l)}}(x(e),t))}},56554:(O,m,u)=>{u.d(m,{MS:()=>b,Dm:()=>v,Hq:()=>x,bU:()=>U});var g=u(8314),G=u(58817),R=u(87757),Z=u(24837);function U(y){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===y||"esriGeometryMultipoint"===y?Z.I4:"esriGeometryPolyline"===y?Z.ET:Z.lF}}}function v(y,I){if((0,g.Z)("esri-csp-restrictions"))return()=>Q({[I]:null},y);try{let P=`this.${I} = null;`;for(const T in y)P+=`this${T.includes(".")?`["${T}"]`:`.${T}`} = ${JSON.stringify(y[T])};`;const K=new Function(P);return()=>new K}catch(P){return()=>Q({[I]:null},y)}}function x(y={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,G.d9)(y)}}]}function b(y,I){return{attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:y},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:I,supportsDelete:I,supportsEditing:I,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAttachments:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:I,supportsExceedsLimitStatistics:!0},query:R.g,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0},editing:{supportsGeometryUpdate:I,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1}}}}}]);