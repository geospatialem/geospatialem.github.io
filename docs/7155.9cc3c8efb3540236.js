"use strict";var fe=Object.defineProperty,ce=Object.defineProperties,he=Object.getOwnPropertyDescriptors,E=Object.getOwnPropertySymbols,Ce=Object.prototype.hasOwnProperty,ge=Object.prototype.propertyIsEnumerable,A=(d,a,t)=>a in d?fe(d,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):d[a]=t,b=(d,a)=>{for(var t in a||(a={}))Ce.call(a,t)&&A(d,t,a[t]);if(E)for(var t of E(a))ge.call(a,t)&&A(d,t,a[t]);return d},Z=(d,a)=>ce(d,he(a));(self.webpackChunksite=self.webpackChunksite||[]).push([[7155],{7155:(d,a,t)=>{t.r(a),t.d(a,{default:()=>ue});var P=t(15861),o=t(17626),G=t(73281),M=t(84792),u=t(26584),y=t(58817),U=t(63290),K=t(62208),D=t(99959),J=t(94113),$=t(10699),z=t(21726),n=t(77712),w=t(90912),Y=t(68653),v=t(76898),H=t(99433),Q=t(63602),W=t(50085),X=t(65088),q=t(49286),k=t(6647),_=t(99555),ee=t(44900),m=t(55342),te=t(86162);t(85931),t(8314);let h=class extends te.wq{constructor(e){super(e),this.field=null,this.type=null}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}};(0,o._)([(0,n.Cb)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],h.prototype,"field",void 0),(0,o._)([(0,n.Cb)({readOnly:!0,nonNullable:!0,json:{read:!1}})],h.prototype,"type",void 0),h=(0,o._)([(0,v.j)("esri.layers.pointCloudFilters.PointCloudFilter")],h);const I=h;var S;let f=S=class extends I{constructor(e){super(e),this.requiredClearBits=null,this.requiredSetBits=null,this.type="bitfield"}clone(){return new S({field:this.field,requiredClearBits:(0,y.d9)(this.requiredClearBits),requiredSetBits:(0,y.d9)(this.requiredSetBits)})}};(0,o._)([(0,n.Cb)({type:[w.z8],json:{write:{enabled:!0,overridePolicy(){return{enabled:!0,isRequired:!this.requiredSetBits}}}}})],f.prototype,"requiredClearBits",void 0),(0,o._)([(0,n.Cb)({type:[w.z8],json:{write:{enabled:!0,overridePolicy(){return{enabled:!0,isRequired:!this.requiredClearBits}}}}})],f.prototype,"requiredSetBits",void 0),(0,o._)([(0,m.J)({pointCloudBitfieldFilter:"bitfield"})],f.prototype,"type",void 0),f=S=(0,o._)([(0,v.j)("esri.layers.pointCloudFilters.PointCloudBitfieldFilter")],f);const re=f;var R;let C=R=class extends I{constructor(e){super(e),this.includedReturns=[],this.type="return"}clone(){return new R({field:this.field,includedReturns:(0,y.d9)(this.includedReturns)})}};(0,o._)([(0,n.Cb)({type:[["firstOfMany","last","lastOfMany","single"]],json:{write:{enabled:!0,isRequired:!0}}})],C.prototype,"includedReturns",void 0),(0,o._)([(0,m.J)({pointCloudReturnFilter:"return"})],C.prototype,"type",void 0),C=R=(0,o._)([(0,v.j)("esri.layers.pointCloudFilters.PointCloudReturnFilter")],C);const oe=C;var x;let c=x=class extends I{constructor(e){super(e),this.mode="exclude",this.type="value",this.values=[]}clone(){return new x({field:this.field,mode:this.mode,values:(0,y.d9)(this.values)})}};(0,o._)([(0,n.Cb)({type:["exclude","include"],json:{write:{enabled:!0,isRequired:!0}}})],c.prototype,"mode",void 0),(0,o._)([(0,m.J)({pointCloudValueFilter:"value"})],c.prototype,"type",void 0),(0,o._)([(0,n.Cb)({type:[Number],json:{write:{enabled:!0,isRequired:!0}}})],c.prototype,"values",void 0),c=x=(0,o._)([(0,v.j)("esri.layers.pointCloudFilters.PointCloudValueFilter")],c);const ne={key:"type",base:I,typeMap:{value:c,bitfield:re,return:oe}};var j,F=t(55400),T=t(36255),ie=t(55911),B=t(38439),se=t(53776),V=t(80573);let g=j=class extends V.Z{constructor(e){super(e),this.type="point-cloud-rgb",this.field=null}clone(){return new j(Z(b({},this.cloneProperties()),{field:(0,y.d9)(this.field)}))}};(0,o._)([(0,m.J)({pointCloudRGBRenderer:"point-cloud-rgb"})],g.prototype,"type",void 0),(0,o._)([(0,n.Cb)({type:String,json:{write:!0}})],g.prototype,"field",void 0),g=j=(0,o._)([(0,v.j)("esri.renderers.PointCloudRGBRenderer")],g);const le=g;var ae=t(23899),de=t(98610);const L={key:"type",base:V.Z,typeMap:{"point-cloud-class-breaks":se.Z,"point-cloud-rgb":le,"point-cloud-stretch":ae.Z,"point-cloud-unique-value":de.Z},errorContext:"renderer"};var pe=t(49430);const N=U.Z.getLogger("esri.layers.PointCloudLayer"),O=(0,ie.v)();let i=class extends((0,ee.V)((0,X.Y)((0,q.q)((0,k.I)((0,_.M)((0,D.R)((0,W.V)(Q.Z)))))))){constructor(...e){super(...e),this.operationalLayerType="PointCloudLayer",this.popupEnabled=!0,this.popupTemplate=null,this.opacity=1,this.filters=[],this.fields=null,this.fieldsIndex=null,this.outFields=null,this.path=null,this.legendEnabled=!0,this.renderer=null,this.type="point-cloud"}normalizeCtorArgs(e,r){return"string"==typeof e?b({url:e},r):e}get defaultPopupTemplate(){return this.attributeStorageInfo?this.createPopupTemplate():null}getFieldDomain(e){const r=this.fieldsIndex.get(e);return r&&r.domain?r.domain:null}readServiceFields(e,r,s){return Array.isArray(e)?e.map(l=>{const p=new T.Z;return"FieldTypeInteger"===l.type&&((l=(0,y.d9)(l)).type="esriFieldTypeInteger"),p.read(l,s),p}):Array.isArray(r.attributeStorageInfo)?r.attributeStorageInfo.map(l=>new T.Z({name:l.name,type:"ELEVATION"===l.name?"double":"integer"})):null}set elevationInfo(e){this._set("elevationInfo",e),this._validateElevationInfo()}writeRenderer(e,r,s,l){(0,J.RB)("layerDefinition.drawingInfo.renderer",e.write({},l),r)}load(e){const r=(0,K.pC)(e)?e.signal:null,s=this.loadFromPortal({supportedTypes:["Scene Service"]},e).catch($.r9).then(()=>this._fetchService(r));return this.addResolvingPromise(s),Promise.resolve(this)}createPopupTemplate(e){const r=(0,pe.eZ)(this,e);return this.formatPopupTemplateReturnsField(r),this.formatPopupTemplateRGBField(r),r}formatPopupTemplateReturnsField(e){const r=this.fieldsIndex.get("RETURNS");if(!r)return;const s=e.fieldInfos.find(p=>p.fieldName===r.name);if(!s)return;const l=new B.Z({name:"pcl-returns-decoded",title:r.alias||r.name,expression:`\n        var returnValue = $feature.${r.name};\n        return (returnValue % 16) + " / " + Floor(returnValue / 16);\n      `});e.expressionInfos=[...e.expressionInfos||[],l],s.fieldName="expression/pcl-returns-decoded"}formatPopupTemplateRGBField(e){const r=this.fieldsIndex.get("RGB");if(!r)return;const s=e.fieldInfos.find(p=>p.fieldName===r.name);if(!s)return;const l=new B.Z({name:"pcl-rgb-decoded",title:r.alias||r.name,expression:`\n        var rgb = $feature.${r.name};\n        var red = Floor(rgb / 65536, 0);\n        var green = Floor((rgb - (red * 65536)) / 256,0);\n        var blue = rgb - (red * 65536) - (green * 256);\n\n        return "rgb(" + red + "," + green + "," + blue + ")";\n      `});e.expressionInfos=[...e.expressionInfos||[],l],s.fieldName="expression/pcl-rgb-decoded"}queryCachedStatistics(e,r){var s=this;return(0,P.Z)(function*(){if(yield s.load(r),!s.attributeStorageInfo)throw new u.Z("scenelayer:no-cached-statistics","Cached statistics are not available for this layer");const l=s.fieldsIndex.get(e);if(!l)throw new u.Z("pointcloudlayer:field-unexisting",`Field '${e}' does not exist on the layer`);for(const p of s.attributeStorageInfo)if(p.name===l.name){const ye=(0,z.v_)(s.parsedUrl.path,`./statistics/${p.key}`);return(0,M.default)(ye,{query:{f:"json",token:s.apiKey},responseType:"json",signal:r?r.signal:null}).then(ve=>ve.data)}throw new u.Z("pointcloudlayer:no-cached-statistics","Cached statistics for this attribute are not available")})()}saveAs(e,r){var s=this;return(0,P.Z)(function*(){return s._debouncedSaveOperations(1,Z(b({},r),{getTypeKeywords:()=>s._getTypeKeywords(),portalItemLayerType:"point-cloud"}),e)})()}save(){var e=this;return(0,P.Z)(function*(){const r={getTypeKeywords:()=>e._getTypeKeywords(),portalItemLayerType:"point-cloud"};return e._debouncedSaveOperations(0,r)})()}validateLayer(e){if(e.layerType&&"PointCloud"!==e.layerType)throw new u.Z("pointcloudlayer:layer-type-not-supported","PointCloudLayer does not support this layer type",{layerType:e.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new u.Z("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"1.x-2.x"});if(this.version.major>2)throw new u.Z("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"1.x-2.x"})}hasCachedStatistics(e){return null!=this.attributeStorageInfo&&this.attributeStorageInfo.some(r=>r.name===e)}_getTypeKeywords(){return["PointCloud"]}_validateElevationInfo(){const e=this.elevationInfo;e&&("absolute-height"!==e.mode&&N.warn(".elevationInfo=","Point cloud layers only support absolute-height elevation mode"),e.featureExpressionInfo&&"0"!==e.featureExpressionInfo.expression&&N.warn(".elevationInfo=","Point cloud layers do not support featureExpressionInfo"))}};(0,o._)([(0,n.Cb)({type:["PointCloudLayer"]})],i.prototype,"operationalLayerType",void 0),(0,o._)([(0,n.Cb)(F.C_)],i.prototype,"popupEnabled",void 0),(0,o._)([(0,n.Cb)({type:G.Z,json:{name:"popupInfo",write:!0}})],i.prototype,"popupTemplate",void 0),(0,o._)([(0,n.Cb)({readOnly:!0,json:{read:!1}})],i.prototype,"defaultPopupTemplate",null),(0,o._)([(0,n.Cb)({readOnly:!0,json:{write:!1,read:!1,origins:{"web-document":{write:!1,read:!1}}}})],i.prototype,"opacity",void 0),(0,o._)([(0,n.Cb)({type:["show","hide"]})],i.prototype,"listMode",void 0),(0,o._)([(0,n.Cb)({types:[ne],json:{origins:{service:{read:{source:"filters"}}},name:"layerDefinition.filters",write:!0}})],i.prototype,"filters",void 0),(0,o._)([(0,n.Cb)({type:[T.Z]})],i.prototype,"fields",void 0),(0,o._)([(0,n.Cb)(O.fieldsIndex)],i.prototype,"fieldsIndex",void 0),(0,o._)([(0,Y.r)("service","fields",["fields","attributeStorageInfo"])],i.prototype,"readServiceFields",null),(0,o._)([(0,n.Cb)(O.outFields)],i.prototype,"outFields",void 0),(0,o._)([(0,n.Cb)({readOnly:!0})],i.prototype,"attributeStorageInfo",void 0),(0,o._)([(0,n.Cb)(F.PV)],i.prototype,"elevationInfo",null),(0,o._)([(0,n.Cb)({type:String,json:{origins:{"web-scene":{read:!0,write:!0},"portal-item":{read:!0,write:!0}},read:!1}})],i.prototype,"path",void 0),(0,o._)([(0,n.Cb)(F.rn)],i.prototype,"legendEnabled",void 0),(0,o._)([(0,n.Cb)({types:L,json:{origins:{service:{read:{source:"drawingInfo.renderer"}}},name:"layerDefinition.drawingInfo.renderer",write:{target:{"layerDefinition.drawingInfo.renderer":{types:L},"layerDefinition.drawingInfo.transparency":{type:Number}}}}})],i.prototype,"renderer",void 0),(0,o._)([(0,H.c)("renderer")],i.prototype,"writeRenderer",null),(0,o._)([(0,n.Cb)({json:{read:!1},readOnly:!0})],i.prototype,"type",void 0),i=(0,o._)([(0,v.j)("esri.layers.PointCloudLayer")],i);const ue=i}}]);